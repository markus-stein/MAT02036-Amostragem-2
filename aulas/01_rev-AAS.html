<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>MAT02036 - Amostragem 2</title>
    <meta charset="utf-8" />
    <meta name="author" content="Markus Stein" />
    <script src="libs/header-attrs-2.18/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, title-slide

.title[
# MAT02036 - Amostragem 2
]
.subtitle[
## Aula 01 - Vis√£o Geral e Revis√£o
]
.author[
### Markus Stein
]
.institute[
### Departamento de Estat√≠stica, IME/UFRGS
]
.date[
### 2022/2
]

---




### *Housekeeping*

* Aproveitem o momento presencial para tirar d√∫vidas

* Se estiv√©ssemos no ensino remoto ou √† dist√¢ncia

  + voc√™s poderiam estar somente ouvindo, sem intera√ß√£o
  
  + ou assistindo v√≠deos e material em outro momento
  
* Depois das aulas, rever material da aula passada

  + fazer exerc√≠cios
  
  + se preparar para a pr√≥xima aula

---

class: inverse, middle, center


<div>
<style type="text/css">.xaringan-extra-logo {
width: 110px;
height: 128px;
z-index: 0;
background-image: url(C:/Users/User/Downloads/MAT02036 - Amostragem 2/aulas/img/logo_dest.png);
background-size: contain;
background-repeat: no-repeat;
position: absolute;
top:1em;right:1em;
}
</style>
<script>(function () {
  let tries = 0
  function addLogo () {
    if (typeof slideshow === 'undefined') {
      tries += 1
      if (tries < 10) {
        setTimeout(addLogo, 100)
      }
    } else {
      document.querySelectorAll('.remark-slide-content:not(.title-slide):not(.inverse):not(.hide_logo)')
        .forEach(function (slide) {
          const logo = document.createElement('div')
          logo.classList = 'xaringan-extra-logo'
          logo.href = null
          slide.appendChild(logo)
        })
    }
  }
  document.addEventListener('DOMContentLoaded', addLogo)
})()</script>
</div>

# Vis√£o geral de amostragem e AAS

---

## Popula√ß√£o de pesquisa 

* Denominamos **popula√ß√£o** qualquer conjunto contendo um n√∫mero finito `\(N\)` de unidades, que compartilham alguma(s) caracter√≠stica(s) em comum;

  + `\(N\)` √© o **tamanho da popula√ß√£o**.

* As unidades deste conjunto s√£o denominadas **unidades da popula√ß√£o**, 

  + representadas por um conjunto de `\(N\)` r√≥tulos distintos denotado 
  `$$U = \{ 1, 2, \ldots, i, \ldots, N\},$$` 
  
  + `\(i\)` o **r√≥tulo** para uma unidade gen√©rica da popula√ß√£o, `\(i \in U\)`. 
  
* Exemplos:
  + domic√≠lios e moradores de certa localidade; 
  + ind√∫strias instaladas num certo pa√≠s; 
  + fazendas situadas num certo estado; 
  + alunos matriculados em uma s√©rie da rede escolar estadual em 2022. 

* Defini√ß√£o clara e precisa da *popula√ß√£o de pesquisa*. 

---

## Popula√ß√£o de pesquisa 

* Queremos **estimar** ou **inferir** certas quantidades ou **par√¢metros** de **caracter√≠sticas** (vari√°veis) **num√©ricas** medidas ou **observadas** para, em tese, toda **unidade da popula√ß√£o**.

* *Vetor populacional* √© o conjunto de valores da vari√°vel correspondentes √†s unidades da popula√ß√£o. 

  + Exemplo, se `\(y\)` √© a vari√°vel de pesquisa (de interesse) e `\(y_i\)` √© o valor dessa vari√°vel `\(y\)` para a unidade `\(i\)`, ent√£o 
  `$$Y_U = \{y_1,\;y_2,\;...,\;y_i,\;..., \;y_N\}$$` 
  √© o *vetor populacional* gerado pela vari√°vel `\(y\)`.

#### **Par√¢metros-alvo** (ou de interesse) podem ser quaisquer fun√ß√µes dos valores dos vetores populacionais: üéØ

**total populacional** (da vari√°vel `\(y\)`) | `\(T_y = T = \displaystyle \sum_{i=1}^{N}y_i=\sum_{i\in U}y_i\)`
-----------------------------------------|---------------------------------------------

---

## Popula√ß√£o de pesquisa 
#### mais *par√¢metros-alvo*: üéØ

*m√©dia populacional* | `\(\overline{Y} = \displaystyle \frac{T_y}{N}=\frac{1}{N}\sum_{i\in U} y_i\)`; 
---------------------|:-------------------------------------------:  
*propor√ß√£o populacional* `\(P\)` | `\(P = \overline{Y}\)`, para `\(y \in \{0,1\}\)`.
*vari√¢ncia populacional* | `\(Var_y = \displaystyle\frac{1}{N} \sum_{i\in U}({y_i-\overline{Y}})^2 = \frac{1}{N}\left[\sum_{i\in U}{y_i}^2-N\overline{Y}^2\right]\)`
*vari√¢ncia populacional* | `\(S^2_y = \displaystyle\frac{1}{N-1} \sum_{i \in U}({y_i-\overline{Y}})^2 = \frac{N}{N-1} Var_y\)`
*desvio padr√£o - DP populacional* | `\(DP_y = \sqrt{Var_y}\)`
*desvio padr√£o - DP populacional* | `\(S_y = \sqrt{S^2_y}\)`
*coeficiente de varia√ß√£o - CV populacional* | `\(CV_y = \displaystyle \frac{DP_y}{\overline Y} = \frac {S_y} {\overline Y}\)`

---

## Popula√ß√£o de pesquisa
#### mais *par√¢metros-alvo*: üéØ

  + a *fun√ß√£o de distribui√ß√£o cumulativa emp√≠rica populacional* - *FDCEP*, por consequ√™ncia, *quantil populacional*, ex. a *mediana populacional*. `\(F_y(a) = \displaystyle \frac{1}{N} \sum_{i\in U} I(y_i \le a)\)`.
  
  + seja `\(z\)` outra vari√°vel de pesquisa, tomando valores `\(z_i\)`, `\(i \in U\)`, a *raz√£o de totais* das vari√°veis `\(y\)` e `\(z\)` como `\(R = {\displaystyle \frac{\sum_{i \in U} y_i} {\sum_{i \in U} z_i}} = \displaystyle {Y}/{Z}\)`
  
  + a *covari√¢ncia populacional* e a *correla√ß√£o populacional* das vari√°veis `\(y\)` e `\(z\)`, `\(S_{yz}=\displaystyle\frac{1}{N-1}\sum_{i\in U}({y_i-\overline{Y}})({z_i-\overline{Z}})=\frac{1}{N-1}\left[\sum_{i\in U}{y_i}{z_i}-N\,\overline{Y}\,\overline{Z}\right]\)` e `\({\rho}_{yz}=\displaystyle\frac{S_{yz}}{S_y S_z}\)`
 
---

class: inverse, middle, center

# **Censo** √© poss√≠vel?
 
---

## Amostragem de popula√ß√µes finitas

* **pesquisa por amostragem** menor custo de obten√ß√£o dos dados, maior rapidez e redu√ß√£o da carga de coleta de informa√ß√µes.
  + conhecendo **estimativas** dos **par√¢metros** e **margem de erro** podemos ter bons resultados?

* Uma **amostra** `\(s=\{i_1, i_2, \dots, i_n\}\)` √© qualquer subconjunto n√£o vazio de unidades selecionadas da popula√ß√£o `\(U\)`, `\(s \subset U\)` `\(( 1 \leq n \leq N )\)`. 

√≠ndice  | soma
------------- | -------------
`\(i \in s\)`: unidade `\(i\)` inclu√≠da na amostra `\(s\)`. | `\(\sum_{i \in s}\)`: em `\(i\)` sobre o conjunto de r√≥tulos de unidades em `\(s\)`. 
`\(s \ni i\)`: a amostra `\(s\)` cont√©m a unidade `\(i\)`.  | `\(\sum_{s \ni i}\)`: em `\(s\)` sobre o conjunto de amostras poss√≠veis que cont√™m a unidade `\(i\)`.

 

* Consideraremos somente **amostras probabil√≠sticas**,
  + os dados amostrais para a vari√°vel `\(y\)` s√£o representados por 
  `$$Y_s = \{y_{i_1}, y_{i_2}, \dots, y_{i_n}\}$$`.

---

## Amostragem probabil√≠stica
#### Suposi√ß√µes

1. `\(S\)`: *espa√ßo amostral*; o conjunto de todas as amostras `\(s\)` poss√≠veis, bem definido e enumer√°vel (teoricamente), 
`\(S = \{ s_1,  s_2, \ldots, s_j, \ldots, s_{\nu} \}\)`;

2. `\(p(s)\)`: uma probabilidade conhecida (ou calcul√°vel) associada a cada amostra `\(s \in S\)`, denominada *plano amostral*,
`$$\displaystyle \sum_{s \in S} p(s) = 1;$$`

3. Uma √∫nica amostra `\(s \in S\)` √© selecionada com probabilidade `\(p(s)\)`.

4. Associada a cada unidade `\(i \in U\)` existe uma probabilidade positiva, `\(\pi_i\)`, dessa ser selecionada, denominada **probabilidade de inclus√£o** (de primeira ordem) da unidade `\(i\)`, tal que 
`$$\pi_i = P(i \in s) = \displaystyle \sum_{s \ni i} p(s) &gt; 0, \forall i \in U.$$` 

5. `\(\pi_i\)` das **unidades selecionadas** e outros aspectos do **plano amostral** s√£o levados em conta ao fazer **infer√™ncia** sobre os par√¢metros.

---

## Estat√≠sticas, estimadores e estimativas

* Uma **estat√≠stica** √© uma fun√ß√£o real dos valores observados numa amostra, qualquer `\(f( y_{i_1}, y_{i_2}, \dots, y_{i_n} )\)`. Exemplos:

  
**total amostral** ou **soma amostral** da vari√°vel `\(y\)` | `\(t(s) = t = \displaystyle \sum_{i \in s} y_i\)`
---|---
**m√©dia amostral** da vari√°vel `\(y\)` | `\(\overline{y} = \displaystyle \frac{t(s)}{n} = \frac{1}{n} \sum_{i \in s} y_i\)`
  
* Um **estimador** `\(\widehat{\theta}(s)\)` √© uma estat√≠stica usada para estimar um certo par√¢metro `\(\theta\)` de interesse. 
  + Antes de observarmos `\(s\)`, `\(\widehat{\theta}(s)\)` √© uma vari√°vel aleat√≥ria (v.a.) cuja distribui√ß√£o temos interesse em conhecer, dela derivamos propriedades importantes de `\(\widehat{\theta}(s)\)`. 
  + Por simplicidade, denotamos `\(\widehat{\theta}\)`, sem explicitar sua depend√™ncia de `\(s\)`, sempre que poss√≠vel.

* Ap√≥s a determina√ß√£o da amostra `\(s\)` e a coleta dos dados das unidades, o valor calculado (observado) de `\(\widehat{\theta}\)` √© chamado de **estimativa** do par√¢metro.

---

class: inverse, middle, center

# Como escolher **"bons" estimadores**?

---

## Propriedades dos estimadores

* O *valor esperado* de `\(\widehat{\theta}\)` √© denotado por `\(E_p(\widehat{\theta})\)`. 
  + `\(E_p(\cdot)\)` designa o valor esperado sob a distribui√ß√£o de probabilidades induzida pelo plano amostral:
`$$E_p (\widehat{\theta}) = \sum_{s \in S} \widehat{\theta}(s) p(s).$$`

* O **v√≠cio** (ou **vi√©s** ou **tend√™ncia**) de `\(\widehat{\theta}\)` √© definido como:
`$$B_p(\widehat{\theta}) = E_p(\widehat{\theta}) - \theta.$$`

* o *v√≠cio relativo* de `\(\widehat{\theta}\)` √© dado por:
`$$RB_p(\widehat{\theta}) =\displaystyle\frac{B_p(\widehat{\theta})}{\theta}.$$`

---

## Propriedades dos estimadores

* `\(\widehat{\theta}\)` √© **n√£o viciado** (ou **n√£o enviesado** ou **n√£o tendencioso**) para `\(\theta\)` quando
`$$E_p(\widehat{\theta}) = \theta,$$`
ou
`$$B_p(\widehat{\theta}) = RB_p(\widehat{\theta}) = 0,$$`

#### **Primeiro crit√©rio** 

* Para apoiar a **escolha de estimadores** sugere ent√£o que tratemos de usar *estimadores* sem v√≠cio, ou *n√£o viciados*, ou ao menos *aproximadamente n√£o viciados*. 

* Quando isto for poss√≠vel, teremos estimadores cuja distribui√ß√£o ser√° centrada no alvo desejado da infer√™ncia.  

* Um mesmo par√¢metro pode ter mais de um estimador n√£o viciado dispon√≠vel. Precisamos ent√£o de um segundo crit√©rio para ajudar na escolha de estimadores.

---

## Propriedades dos estimadores
#### Quando um estimador √© **n√£o viciado**

* Nesse caso a *vari√¢ncia* de `\(\widehat{\theta}\)` mede a dispers√£o da distribui√ß√£o do estimador em torno do alvo de infer√™ncia `\(\theta\)`. 

* A *vari√¢ncia* do estimador `\(\widehat{\theta}\)` √© definida como:
`$$Var_p(\widehat{\theta}) = \displaystyle \sum_{s \in S} [\widehat{\theta}(s) - E_p(\widehat{\theta})]^2 p(s).$$`

* Medidas alternativas da dispers√£o de `\(\widehat{\theta}\)` (que dependem da vari√¢ncia s√£o): 

**Desvio padr√£o** - *DP* (ou **erro padr√£o**) | `\(DP_p(\widehat{\theta}) = [Var_p(\widehat{\theta})]^{1/2}\)`.
----------------------------------------------|--------------------------------------
**Coeficiente de varia√ß√£o** - **CV**          | `\(CV_p(\widehat{\theta}) = \displaystyle\frac{DP_p(\widehat{\theta})}{\theta}\)`

* O *DP* mede a dispers√£o em unidade de medida igual √† usada na mensura√ß√£o da vari√°vel de interesse; e o *CV* expressa essa medida em termos relativos. 

---

## Propriedades dos estimadores
#### Quando um estimador √© **viciado**

* Uma medida mais adequada da dispers√£o da distribui√ß√£o do estimador em torno do alvo de infer√™ncia `\(\theta\)` √© o **erro quadr√°tico m√©dio** - **EQM**:
`$$EQM_p(\widehat{\theta}) = \displaystyle \sum_{s\in S} [\widehat{\theta}(s) - \theta]^2 p(s)$$`

* Vers√µes an√°logas ao `\(DP\)` e do `\(CV\)` para o caso de estimadores viciados: 

*Erro m√©dio* - *EM*           | `\(EM_p(\widehat{\theta}) = [EQM_p(\widehat{\theta})]^{1/2}\)`;
------------------------------|--------------------------------------
*Erro relativo m√©dio* - *ERM* | `\(ERM_p(\widehat{\theta}) = \displaystyle\frac{EM_p(\widehat{\theta})}{\theta}\)`.

#### Nosso segundo crit√©rio 
* Queremos estimadores com os menores erros de estima√ß√£o, 
  + escolher sempre os estimadores com o menor *EQM*, 
  + ou com a menor vari√¢ncia quando forem n√£o viciados.

---

class: inverse, middle, center

# Como obter estimadores "√≥timos"?

---

## Obten√ß√£o de estimadores

* Qual a diferen√ßa entre "Amostragem" ou "Infer√™ncia"?
  + Ambas utlizam amostras probabil√≠sticas e fun√ß√µes dos dados observados para inferir sobre par√¢metros.

### No **contexto da Amostragem** (de popu√ß√µes finitas)

* N√£o se estabelece uma distribui√ß√£o de probabilidade (ou modelo) para os valores da vari√°vel `\(y\)` na amostra (ou na popula√ß√£o(?)).
  + diferente do "contexto usual" da **Infer√™ncia** (Estat√≠stica).  
  
* Os par√¢metros que se deseja estimar n√£o s√£o respons√°veis pela especifica√ß√£o de uma tal distribui√ß√£o de probabilidades (ou modelo). 
  + Em geral os par√¢metros de interesse s√£o definidos como fun√ß√µes dos valores (considerados fixos, mas desconhecidos) da vari√°vel `\(y\)` na popula√ß√£o. 

* N√£o h√° um procedimento geral para gerar estimadores que sejam √≥timos nalgum sentido, 
  + ex., em "Infer√™ncia" temos o *m√©todo da m√°xima verossimilhan√ßa*.
  
---

## Obten√ß√£o de estimadores

* Os princ√≠pios usados em "Amostragem" para derivar estimadores dos par√¢metros de interesse s√£o baseados na simplicidade e no *m√©todo dos momentos*.

Suponha que o par√¢metro-alvo √© o *total populacional* `\(T_y = \displaystyle \sum_{i \in U} y_i\)`, queremos:  
a. usar os *dados amostrais* `\(\{y_{i_1}, y_{i_2}, \dots, y_{i_n}\}\)` para *estimar* `\(T\)`;  
b. medir ou estimar a *precis√£o* ou a *margem de erro* da estimativa produzida para `\(T\)`.

* Um **estimador linear** `\(\widehat T_w\)` do total populacional `\(T\)` √© uma combina√ß√£o linear dos valores amostrais `\(y_i\)` com *pesos amostrais* `\(w_i\)`, a serem definidos,  

`$$\widehat T_w = \displaystyle \sum_{i \in s} {w_i}{y_i}.$$`
	 
* Podemos usar os 2 crit√©rios sugeridos para escolha de estimadores para determinar os pesos `\(w_i\)`,
`$$\widehat{\theta}_{opt} = arg \: min_{\widehat{\theta}} EQM_p(\widehat{\theta}).$$` 

---

## Obten√ß√£o de estimadores
### Exemplo: estima√ß√£o do total e AAS

* Considere uma popula√ß√£o fict√≠cia com `\(N=4\)` mulheres (unidades populacionais), de quem foi indagado o n√∫mero de filhos tidos nascidos vivos (a vari√°vel `\(y\)`).

.center[
*Valor da vari√°vel `\(y\)` por unidade da popula√ß√£o de mulheres*
]

R√≥tulo da unidade `\((i)\)`   | 1  |  2 |  3 |  4 | Total
--------------------------|:-----:|:--:|:--:|:--:|:--:
Valor da vari√°vel `\((y_i)\)` | 0  |  0 |  2 | 1  |   3

* Existem `\({4 \choose 2} = 6 = \nu\)` amostras poss√≠veis de duas **unidades distintas**. 

* O conjunto de todas as amostras poss√≠veis √© dado por
`$$S = \{(1;2); (1;3); (1;4); (2;3); (2;4); (3;4)\}.$$` 

---

## Obten√ß√£o de estimadores
### Exemplo: estima√ß√£o do total e AAS

* Considere tamb√©m um **plano amostral** `\(p_1\)`:
  + `\(p_1(s) = 1/6,  \forall s \in S\)`.  


```r
N &lt;- 4               # no. elementos na pop.
i &lt;- 1:N             # indice dos elementos da pop.
n &lt;- 2               # no. elementos na amostra
nu &lt;- choose(N, n)   # no. poss√≠veis amostras
j &lt;- 1:nu            # indice dos elementos dos espa√ßo amostral
S &lt;- combn(N,n)      # espa√ßo amostral
p1s &lt;- 1/nu           # plano amostral
```

---

## Obten√ß√£o de estimadores
### Exemplo: estima√ß√£o do total e AAS

* Apresenta√ß√£o detalhada do *plano amostral* `\(p_1\)`.

.center[
*Informa√ß√µes de cada amostra poss√≠vel sob plano amostral `\(p_1\)`*
]

Amostra | Unidades na Amostra `\(s\)` | Valores na Amostra `\(s\)` | Soma Amostral `\((t)\)` | Probabilidades `\(p_1(s)\)`  
:------:|:-----------------------:|:----------------------:|:-------------------:|:----------------------:
 1      |       {1;2}            |           {0;0}	       |         0	          |            1/6
 2      |       {1;3}            |           {0;2}	       |         2            |            1/6
 3      |       {1;4}            |           {0;1}	       |         1            |            1/6
 4      |       {2;3}            |           {0;2}	       |         2            |            1/6
 5      |       {2;4}            |           {0;1}	       |         1            |            1/6
 6      |       {3;4}            |           {2;1}	       |         3            |            1/6
 Total  |         _              |               _         |             _        |             1

---

## Obten√ß√£o de estimadores
### Exemplo: estima√ß√£o do total e AAS

.center[
*Probabilidade sob `\(p_1\)` para cada valor de `\(t\)`*
]

Valores poss√≠veis de `\(t\)`  |   0   |  1  |   2   |  3
--------------------------|-----|-----|-----|-----
Com probabilidade `\(p_1(s)\)`|  1/6  | 2/6 |  2/6  | 1/6

* O valor esperado de `\(t\)` √© 

`$$E_{p_1}(t) = \displaystyle\sum_{s \in S} t(s) \, p_1(s) = 0\times\frac{1}{6}+1\times\frac{2}{6}+2\times\frac{2}{6}+3\times\frac{1}{6}= \frac{9}{6} = 1,5$$`
* Por√©m o **total populacional** √© `\(T_y = \displaystyle \sum_{i \in U} y_i = 3\)`. 

* Como `\(1,5 =  E_{p_1}(t) \neq T = 3\)`, dizemos que `\(t\)` seria um **estimador viciado** de `\(T\)` sob o plano amostral `\(p_1\)` adotado.

---

## Obten√ß√£o de estimadores
### Exemplo: estima√ß√£o do total e AAS

* Podemos **"corrigir"** `\(t\)` de modo que fique **n√£o viciado** para o total populacional;
  + J√° que `\(Y / E_{p_1}(t) = 3 / 1,5 = 2\)`, multiplicando por 2 o valor de `\(t\)` resulta num estimador cujo valor esperado deve ser igual a `\(Y\)`.

* Considere o novo estimador de `\(T\)` dado por: `\(\widehat{T} = 2 \times t = \displaystyle \sum_{i \in s} 2 \times y_i = \widehat T_w\)`. 

.center[
*Probabilidade sob `\(p_1\)` para cada valor de `\(2t\)`*
]

Valores poss√≠veis de `\(2t\)` |     0   |  2  |   4   |  6
--------------------------|:-----:|:-----:|:-----:|:-----: 
Com probabilidade `\(p_1(s)\)`|   1/6 |  2/6  | 2/6   | 1/6

`$$E_{p_1}(\widehat T) = \displaystyle \sum_{s \in S} \widehat T(s) \, p_1(s) = 0 \times \frac{1}{6} + 2 \times \frac{2}{6} + 4 \times \frac{2}{6} + 6 \times \frac{1}{6} = \frac{18}{6} = 3.$$`
* Dizemos que `\(\widehat T = 2 \times t\)` √© um **estimador n√£o viciado** de `\(T\)` sob o plano amostral `\(p_1\)` considerado.


---

class: inverse, middle, center

# O m√©todo pelo qual deduzimos `\(\widehat T_w\)` √© vi√°vel na pr√°tica?

---

## A distribui√ß√£o de aleatoriza√ß√£o 
### Plano amostral `\(p(s)\)`

* Para deduzir os pesos do estimador `\(\widehat T_w\)` **supomos**: 

  + conhecer todos os valores da vari√°vel de pesquisa; 
  
  + para obter o valor esperado do estimador;
  
  + para ent√£o calcular pesos que levariam √† obten√ß√£o do estimador ponderado n√£o viciado.

--

* A fun√ß√£o `\(p(s)\)` definida no conjunto `\(S\)` de todas as amostras poss√≠veis √© uma distribui√ß√£o de probabilidades. 

  + √â poss√≠vel obter a distribui√ß√£o de probabilidades de estat√≠sticas (ou estimadores) calculadas a partir  de `\(s\)`. 
  
* A distribui√ß√£o de probabilidades assim obtida √© chamada de **distribui√ß√£o de aleatoriza√ß√£o** da estat√≠stica ou estimador.

---

## A distribui√ß√£o de aleatoriza√ß√£o 
### Plano amostral `\(p(s)\)`

* Na **amostragem probabil√≠stica**, infer√™ncias s√£o feitas considerando a **distribui√ß√£o de aleatoriza√ß√£o**.

  + A √∫nica **suposi√ß√£o** √© considerar como fonte de varia√ß√£o ou incerteza a poss√≠vel repeti√ß√£o hipot√©tica do processo de amostragem utilizando o **plano amostral** `\(p(s)\)`, que resultaria em diferentes amostras `\(s_1, s_2, ... \in S\)`.

--

* A distribui√ß√£o de `\(\widehat T_w = 2 \times t = \displaystyle \sum_{i \in s} 2 \times y_i\)` determinada por `\(p(s)\)` √© tamb√©m chamada de **distribui√ß√£o amostral** do estimador. 

  + Estudamos suas propriedades para avaliar se `\(\widehat T_w\)` √© um bom estimador para o total populacional `\(T\)`.

---

## Estimadores n√£o viciados para o total populacional

* No Exemplo vimos como ober a *distribui√ß√£o amostral* de um estimador induzida pelo plano amostral `\(p(s)\)`. 

  + Os tamanhos da popula√ß√£o `\(N\)` e da amostra `\(n\)` eram muito pequenos.    
  
  + conhecemos os valores da vari√°vel `\(y\)` para todas as unidades da popula√ß√£o `\(U\)`.  

* Na pr√°tica, trabalhar com a distribui√ß√£o `\(p(s)\)` para derivar distribui√ß√µes amostrais de estimadores √© complicado. 

.center[
*Tamanhos do espa√ßo amostral `\(S\)` para valores selecionados de `\(N\)` e `\(n\)`*
]

```r
# Gera tabela com valores de binom(N,n)
tabela &lt;- as.data.frame(  
          rbind( c(4, 2, choose(4,2)),
                 c(10, 4, choose(10,4)),
                 c(100, 10, choose(100,10)),
                 c(1000, 20, choose(1000,20)),
                 c(10000, 100, choose(10000,100))) )
colnames(tabela) &lt;- c("N", "n", "binom(N,n)")
```

---

## Estimadores n√£o viciados para o total populacional

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; N &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; n &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; binom(N,n) &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.000000e+00 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.100000e+02 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 100 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.731031e+13 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.394828e+41 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 10000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 100 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.520847e+241 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

* Uma sa√≠da √© usar propriedades simplificadoras da distribui√ß√£o induzida pelo plano amostral. Tratamos disso na pr√≥xima aula.

* Por hora vamos usar uma propriedade importante que pode ser deduzida a partir da distribui√ß√£o de aleatoriza√ß√£o. 

---

## Estimadores n√£o viciados para o total populacional

* A *probabilidade de inclus√£o* da unidade `\(i\)` na amostra √© dada por: 
`$$P({i \in s}) = \pi_i = \displaystyle \sum_{s \ni i} p(s).$$`

* Se tomarmos o *inverso da probabilidade de inclus√£o* `\({1}/{\pi_i}\)` como peso `\((w_i)\)` de uma unidade amostrada, √© f√°cil verificar que o estimador dado por `\(\widehat T_w\)` √© *n√£o viciado* para o total populacional `\(T\)`:

`$$\widehat T_w = \displaystyle \sum_{i \in s} w_i y_i = \displaystyle \sum_{i \in s}  \frac{1}{\pi_i} y_i = \displaystyle \sum_{i \in s} {\pi_i}^{-1} y_i.$$`

* Essa √© propriedade importante e ser√° demonstrada de maneira formal na pr√≥xima aula. 

---

## Estimadores n√£o viciados para o total populacional
### (cont.)  Exemplo: estima√ß√£o do total e AAS

* Usando a propriedade rec√©m apresentada, os pesos amostrais nesse Exemplo s√£o 
`$$w_i = {1}/{\pi_i} = \frac{1}{1/2} = 2, \forall i,$$` 
para uma das amostras de tamanho `\(n=2\)`.

* O estimador ponderado do total nesse caso seria dado por: 
`$$\widehat T_w = \displaystyle \sum_{i \in s} w_i y_i = \displaystyle \sum_{i \in s} {\pi_i}^{-1} y_i = \displaystyle \sum_{i \in s} 2 y_i = 2t.$$`

* J√° sabemos que este estimador √© n√£o viciado para `\(T\)`.

---

## Estimadores n√£o viciados para o total populacional
### (cont.)  Exemplo: estima√ß√£o do total e AAS

* Considere a mesma popula√ß√£o fict√≠cia do exemplo anterior. 

* Mas agora adote o plano amostral `\(p_2\)` (para amostras de tamanho `\(n=2\)`). 

.center[
*Informa√ß√µes de cada amostra poss√≠vel sob plano amostral `\(p_2\)`*
]

Amostra | Unidades na Amostra `\(s\)` | Valores na Amostra `\(s\)` | Soma Amostral `\((t)\)` | Probabilidades `\(p_2(s)\)`  
--------|:-:|:-:|:-:|:-:
 1	   |       {1;2}         |             {0;0}	    |             0	         |              0,00
 2     |        {1;3}       |               {0;2}     |              2          |               0,20
 3     |        {1;4}       |                {0;1}    |               1        |                 0,15
 4     |        {2;3}       |                {0;2}    |               2        |                 0,20
 5    |         {2;4}       |                {0;1}    |               1        |                 0,15
 6    |         {3;4}        |                {2;1}   |                3       |                  0,30
 Total    |        _         |             _        |             _           |              1,00

---

## Estimadores n√£o viciados para o total populacional
### (cont.)  Exemplo: estima√ß√£o do total e AAS

* Vamos agora usar as informa√ß√µes acima para:

1.Verificar que a estat√≠stica soma amostral `\((t)\)` √© viciada para estimar o total populacional `\(T\)`.    
2.Obter / definir um estimador n√£o viciado para o total populacional `\(T\)`.

.center[
*Probabilidade sob `\(p_2\)` para cada valor de `\(t\)`*
]

Valores poss√≠veis de `\(t\)`  |  0  |   1   |  2  |   3
--------------------------|: -----:|:-----:|:-----:|:-----:
Com probabilidade `\(p_2(s)\)`  | ‚ùì‚ùì‚ùì   | ‚ùì‚ùì‚ùì   | ‚ùì‚ùì‚ùì  |  ‚ùì‚ùì‚ùì

---

## Estimadores n√£o viciados para o total populacional
### (cont.)  Exemplo: estima√ß√£o do total e AAS

* Vamos agora usar as informa√ß√µes acima para:

1.Verificar que a estat√≠stica soma amostral `\((t)\)` √© viciada para estimar o total populacional `\(T\)`.    
2.Obter / definir um estimador n√£o viciado para o total populacional `\(T\)`.

.center[
*Probabilidade sob `\(p_2\)` para cada valor de `\(t\)`*
]

Valores poss√≠veis de `\(t\)`  |  0  |   1   |  2  |   3
--------------------------|: -----:|:-----:|:-----:|:-----:
Com probabilidade `\(p_2(s)\)`  |  0,0  |  0,3  |  0,4  |  0,3

* O valor esperado de `\(t\)` sob o plano amostral `\(p_2\)` √©:
`$$E_{p_2}(t) = ‚ùì‚ùì‚ùì$$`

---

## Estimadores n√£o viciados para o total populacional
### (cont.)  Exemplo: estima√ß√£o do total e AAS

* Vamos agora usar as informa√ß√µes acima para:

1.Verificar que a estat√≠stica soma amostral `\((t)\)` √© viciada para estimar o total populacional `\(T\)`.

2.Obter / definir um estimador n√£o viciado para o total populacional `\(T\)`.

.center[
*Probabilidade sob `\(p_2\)` para cada valor de `\(t\)`*
]

Valores poss√≠veis de `\(t\)`  |  0  |   1   |  2  |   3
--------------------------|: -----:|:-----:|:-----:|:-----:
Com probabilidade `\(p_2(s)\)`  |  0,0  |  0,3  |  0,4  |  0,3

* O valor esperado de `\(t\)` sob o plano amostral `\(p_2\)` √©:

`$$E_{p_2}(t) = \displaystyle \sum_{s \in S} t(s) p_2(s) = 0 \times 0,0 + 1 \times 0,3 + 2 \times 0,4 + 3\times 0,3 = 2&lt;3 = T$$`

---

## Estimadores n√£o viciados para o total populacional
### (cont.)  Exemplo: estima√ß√£o do total e AAS

* Para obter um estimador n√£o viciado, devemos calcular pesos adequados para as unidades amostrais.

.center[
Probabilidade de inclus√£o e peso amostral de cada unidade sob o plano amostral `\(p_2\)`
]

R√≥tulo da unidade `\((i)\)` |      1        |  2      |      3    |      4        
------------------------|:--------------:|: ------------:|: ------------:|:-----------:|:-----------: 
Probabilidade de inclus√£o `\(({\pi}_i)\)` |  ‚ùì‚ùì‚ùì  |  ‚ùì‚ùì‚ùì  |  ‚ùì‚ùì‚ùì  | ‚ùì‚ùì‚ùì  
Peso `\((w_i)\)`      | ‚ùì‚ùì‚ùì |  ‚ùì‚ùì‚ùì |  ‚ùì‚ùì‚ùì | ‚ùì‚ùì‚ùì

---

## Estimadores n√£o viciados para o total populacional
### (cont.)  Exemplo: estima√ß√£o do total e AAS

* Para obter um estimador n√£o viciado, devemos calcular pesos adequados para as unidades amostrais. 

.center[
Probabilidade de inclus√£o e peso amostral de cada unidade sob o plano amostral `\(p_2\)`
]

R√≥tulo da unidade `\((i)\)` |      1        |  2      |      3    |      4        
------------------------|:--------------:|: ------------:|: ------------:|:-----------:|:-----------: 
Probabilidade de inclus√£o `\(({\pi}_i)\)` |  7/20=0,35  |  7/20=0,35  |  7/10=0,70  | 3/5=0,60  
Peso `\((w_i)\)`      |                      20/7=2,857 |  20/7=2,857 |  10/7=1,429 | 5/3=1,667

* Usando o estimador do total com os pesos adequados `\(\widehat T_w\)`, obt√™m-se os valores das estimativas para cada amostra poss√≠vel. 

---

## Estimadores n√£o viciados para o total populacional
### (cont.)  Exemplo: estima√ß√£o do total e AAS

.center[
*Obten√ß√£o de estimativa sob plano amostral `\(p_2\)` para cada amostra poss√≠vel*
]

Amostra |  Valores na Amostra `\(s\)` |  Total Amostral ponderado |  Probabilidades `\(p_2(s)\)`  | Total `\(\times\)` probabilidade
---------|:------------------------:|:--------------------------:|:-------------------------:|:---------------------:
    1   |         {0;0}	      |         0	                     |          0,00	         |             0
    2   |         {0;2}	      |         2x(10/7)               |           0,20         |             4/7
    3   |         {0;1}       |          1x(5/3)               |            0,15         |             1/4
    4   |         {0;2}       |          2x(10/7)             |             0,20        |              4/7
    5   |         {0;1}       |          1x(5/3)              |             0,15         |             1/4
    6   |         {2;1}       |          2x(10/7)+1x(5/3)     |             0,30        |            6/7+1/2
  Total  |          	-      |           -                   |              1,00         |              3

---

## Estimadores n√£o viciados para o total populacional
### (cont.)  Exemplo: estima√ß√£o do total e AAS

1. O estimador `\(\widehat T_w\)` obtido usando os pesos iguais a `\(1 / \pi_i\)` tem valor esperado igual ao total populacional `\(T\)`. 

  + `\(\widehat T_w\)` √© *n√£o viciado* tamb√©m sob o plano amostral `\(p_2\)`.  

--

2. Mesmo a **amostra 1** tendo **probabilidade nula** de ser selecionada **n√£o viola** os crit√©rios para que `\(p_2\)` seja um plano de **amostragem probabil√≠stica**. 

  + as unidades populacionais t√™m probabilidades positivas de inclus√£o na amostra. (Verificar‚ùó‚ùó‚ùó)  

--

3. Temos agora duas op√ß√µes de plano amostral (de tamanho `\(n=2\)`), para estimar o total populacional `\(T\)`. 

  + para ambos os planos amostrais temos estimadores n√£o viciados do total populacional. 

#### Coloca-se ent√£o a pergunta: qual dos dois planos √© melhor‚ùì‚ùì‚ùì


---

## Estimadores n√£o viciados para o total populacional
### (cont.)  Exemplo: estima√ß√£o do total e AAS

* **Estrat√©gia 1:** sele√ß√£o equiprov√°vel de amostras com estimador de total ponderado `\((\widehat T = 2t)\)`.

.center[
*Probabilidade de sele√ß√£o sob `\(p_1(s)\)` para cada valor do estimador ponderado*
]

Valores poss√≠veis de `\(\widehat T=2t\)`  |  0  | 2 |    4  |  6      
---------------------------------------|:----:|:----:|:----:|:----- 
Com probabilidade `\(p(s)\)` sob `\(p_1(s)\)`   | 1/6 | 2/6 |  2/6  | 1/6  

--

* **Estrat√©gia 2:** sele√ß√£o de amostras com probabilidades desiguais e estimador de total ponderado `\((\widehat T_w)\)`. 

.center[
*Probabilidade de sele√ß√£o sob `\(p_2(s)\)` para cada valor do estimador ponderado*
]

Valores poss√≠veis de `\(\widehat T_w\)`   |  5/3  | 20/7  |  20/7+5/3      
-------------------------------------|:-----:|: ------ ---------- 
Com probabilidade `\(p(s)\)` sob `\(p_2(s)\)` | 0,30  | 0,40  | 0,30

---

## Estimadores n√£o viciados para o total populacional
### (cont.)  Exemplo: estima√ß√£o do total e AAS

* Em ambos os casos o estimador √© n√£o viciado, ent√£o comparamos ad *vari√¢ncias dos estimadores*.

.center[
*Obten√ß√£o da vari√¢ncia dos estimadores sob os planos amostrais `\(p_2\)` e `\(p_1\)`*
]

Amostra   |  Valores na Amostra `\(s\)` |  Estimativa sob `\(p_2\)` |   Probabilidade sob `\(p_2\)` |  Estimativa sob `\(p_1\)` |  Probabilidade sob `\(p_1\)`    
-----------|:---:|:--:|:--:|:--:|:--:
   1	   |         {0;0}	    |             0	                |        0,00	            |           0         |            1/6
   2	   |         {0;2}	    |             2x(10/7)	        |          0,20           |              4     |                1/6
   3     |         {0;1}	    |             1x(5/3)          |          0,15            |             2	     |              1/6
   4     |         {0;2}	    |             2x(10/7)         |          0,20            |             4      |               1/6
   5     |         {0;1}	    |             1x(5/3)          |          0,15            |             2      |               1/6
   6      |        {2;1}      |            2x(10/7)+1x(5/3)  |          0,30             |            6      |               1/6
Vari√¢ncia  |        -         |           1,24              |         -   	            |         3,67	    |               -

---

## Estimadores n√£o viciados para o total populacional
### (cont.)  Exemplo: estima√ß√£o do total e AAS

* O plano amostral `\(p_2\)` fornece o *estimador n√£o viciado com menor vari√¢ncia* em compara√ß√£o com o plano `\(p_1\)` e deve ser preferido, pois o tamanho das amostras (nossa medida de custo) √© o mesmo.

* **Minimizar a vari√¢ncia** √© o crit√©rio de desempate para escolha entre *estrat√©gias n√£o viciadas de amostragem e estima√ß√£o* de *igual custo total*. 

#### Este ser√° ent√£o nosso segundo crit√©rio para escolha de estimadores. üëç

---

## Para casa üè†

* Compare o `\(EQM\)` dos estimadores `\(t\)` e `\(2t\)`, sob o plano `\(p_1\)`, no Exemplo.
* Verificar se todas unidades populacionais t√™m probabilidade positiva de inclus√£o na amostra sob `\(p_2\)`, no Exemplo.
* Qual o peso `\(w_i\)` para AASs e AASc?
* Rever os slides.
* Refazer o Exemplo.
* Ler se√ß√£o 3,7 do livro 'Amostragem: Teoria e Pr√°tica Usando R'.



## Pr√≥xima aula üìä

* Teoria b√°sica
  + Estimador linear do total
  + Propriedados do estimador Horvitz-Thompson

* Laborat√≥rio de <svg aria-hidden="true" role="img" viewBox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:steelblue;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg>




---

## Muito obrigado!

&lt;img src="img/image_basu_elephant.jpg" width="30%" height="30%" style="display: block; margin: auto;" /&gt;
Fonte: imagem do livro *Combined Survey Sampling Inference: Weighing of Basu's Elephants: Weighing Basu's Elephants*.

---

## Resumo da nota√ß√£o

Nota√ß√£o | Popula√ß√£o | Amostra
---|:---:|:---
√çndice (r√≥tulo) | `\(U = \{ 1, 2, \ldots, i, \ldots, N\}\)` | `\(s=\{i_1, i_2, \dots, i_n\}\)`
Caracter√≠stica  | `\(Y_U = \{y_1,\;y_2,\;...,\;y_i,\;..., \;y_N\}\)` | `\(Y_s = \{y_{i_1}, y_{i_2}, \dots, y_{i_n}\}\)`
Total           | `\(T = \sum_{i=1}^{N}y_i=\sum_{i\in U}y_i\)` | `\(\widehat{T} = t(s) = t = \sum_{i \in s} y_i\)`
M√©dia           | `\(\overline{Y} = \frac{T}{N}=\frac{1}{N}\sum_{i\in U} y_i\)` | `\(\widehat{\overline{Y}} = \overline{y} = \frac{t(s)}{n} = \frac{1}{n} \sum_{i \in s} y_i\)`
Vari√¢ncia       | `\(Var_y = \frac{1}{N} \sum_{i\in U}({y_i-\overline{Y}})^2\)` | `\(var_y = \frac{1}{n} \sum_{i\in s}(y_i - \overline y)^2\)`
Vari√¢ncia       | `\(S^2_y = \frac{1}{N-1} \sum_{i \in U}({y_i-\overline{Y}})^2\)` | `\(s^2_y = \frac{1}{n-1} \sum_{i \in s}(y_i - \overline y)^2\)`


&lt;!-- Propor√ß√£o       | `\(p = \overline{Y}\)`, para `\(Y \in \{0,1\}\)` | --&gt;

&lt;!-- Vari√¢ncia*       | `\(S^2_y = \displaystyle\frac{1}{N-1} \sum_{i\in}({y_i-\overline{Y}})^2 = \frac{1}{N-1}\left[\sum_{i\in U}{y_i}^2-N\overline{Y}^2\right]\)` |  --&gt;


* Espa√ßo amostral: `\(S = \{ s_1,  s_2, \ldots, s_j, \ldots, s_{\nu} \}\)`
* Plano amostral: `\(p(s)\)`, em que `\(\sum_{s \in S} p(s) = 1\)` 
* Esperan√ßa em rela√ß√£o a `\(p(s)\)`: `\(E_p [t(s)] = \sum_{s \in S} t(s) p(s)\)`
* Vari√¢ncia  em rela√ß√£o a `\(p(s)\)`: `\(Var_p [t(s)] = \sum_{s \in S} [t(s) - E_p(t)]^2 p(s)\)`
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
