<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>MAT02036 - Amostragem 2</title>
    <meta charset="utf-8" />
    <meta name="author" content="Markus Stein" />
    <script src="libs/header-attrs-2.18/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, title-slide

.title[
# MAT02036 - Amostragem 2
]
.subtitle[
## Aula 10 - Amostragem Estratificada - Avalia√ß√£o Parcial 1
]
.author[
### Markus Stein
]
.institute[
### Departamento de Estat√≠stica, IME/UFRGS
]
.date[
### 2022/2
]

---




<div>
<style type="text/css">.xaringan-extra-logo {
width: 110px;
height: 128px;
z-index: 0;
background-image: url(C:/Users/User/Downloads/MAT02036 - Amostragem 2/aulas/img/logo_dest.png);
background-size: contain;
background-repeat: no-repeat;
position: absolute;
top:1em;right:1em;
}
</style>
<script>(function () {
  let tries = 0
  function addLogo () {
    if (typeof slideshow === 'undefined') {
      tries += 1
      if (tries < 10) {
        setTimeout(addLogo, 100)
      }
    } else {
      document.querySelectorAll('.remark-slide-content:not(.title-slide):not(.inverse):not(.hide_logo)')
        .forEach(function (slide) {
          const logo = document.createElement('div')
          logo.classList = 'xaringan-extra-logo'
          logo.href = null
          slide.appendChild(logo)
        })
    }
  }
  document.addEventListener('DOMContentLoaded', addLogo)
})()</script>
</div>

### *Housekeeping*

* A avalia√ß√£o √© composta por **cinco** exerc√≠cios. üèÉ

  + Pode ser feito **√† m√£o** ou **em c√≥digos**, de qualquer forma ser√£o **postados no moodle**.
  
  + Indicar **nota√ß√µes** e **f√≥rmulas** utilizadas.
  
  + Mostrar **desenvolvimento**, **interpreta√ß√£o** e **conclus√£o**.

* Discutam as resolu√ß√µes com os colegas, mas a **entrega** √© **individual**.

  + colabora√ß√£o √© importante, mas c√≥pia √© proibido.

**Extra: (1.0 ponto)** para quem entregou o exerc√≠cio da aula 08.

.center[
### Boa Avalia√ß√£o!
]

---

class: inverse, middle, center

# Avalia√ß√£o Parcial 1

---

##  Exerc√≠cio 1 üèã
#### (2,0 pontos) Revisar exerc√≠cios 1 e 2 com resolu√ß√£o nos slides 'Aula 08'.

* Quem j√° entregou, conferir seus resultados com a resolu√ß√£o atualizada nos slides da `Aula 08`.

  + Alguma discord√¢ncia com a resolu√ß√£o?

* Quem fez parcialmente e/ou n√£o entregou, ...

---

##  Exerc√≠cio 2 üèãÔ∏è‚Äç‚ôÄÔ∏è
#### (2,0 pontos) Exerc√≠cio 3 dos slides 'Aula 08' modificado.

  a. Conferir c√°lculos da letra (a) do exerc√≠cio original nos slides da `Aula 08`.
  
  b. A aloca√ß√£o apresenta `\(n_h &gt; N_h\)`? Se sim, como realocar?
  
  c. Apresente uma estimativa do faturamento total `\(T_y\)` por ponto e por intervalo, de acordo com o realocamento em (b). Interprete.

*(b√¥nus)*: No item (a), mostrar que tamanho da amostra para m√©dia √© equivalente ao tamanho para o total, usando `\(V\)` e a f√≥rmula de `\(n\)` adequados para cada caso.

---

##  Exerc√≠cio 3 üèÉ‚Äç‚ôÄ
#### (2,0 pontos) Banco de dados `Lucy`. (arquivo `Aula_AE_xxx.R`)

Assuma que o banco de dados `Lucy` represente uma popula√ß√£o.

  a. Apresente o tamanho na popula√ß√£o por estrato, os par√¢metros m√©dia e vari√¢ncia populacionais da vari√°vel `Income`, por estrato e globias, usando `Zone` como vari√°vel estratificadora. Repita para a vari√°vel `Level` como estratificadora.
  
  b. Supondo **AASc** de 30 empresas em cada estrato, calcule a vari√¢ncia do estimador da m√©dia de `Income`, comparando o desempenho de `Zone` e `Level` como vari√°veis estratificadoras.

  c. Qual a melhor vari√°vel para estratifica√ß√£o? Justifique, por exemplo, calculando efeito de planejamento `\(EPA\)` `\((deff)\)` em cada caso.
  
  d. Selecione uma amostra com a aloca√ß√£o definida no item (b) e obtenha uma estimativa pontual e intervalar para a m√©dia de `Income`. Interprete.

*(b√¥nus)*: Adicionar comandos para obtet total de `Income`.
  
*(b√¥nus 2)*: Adicionar comandos para obter propor√ß√£o de `SPAM`.

---

##  Exerc√≠cio 4 üí™ - *Assuma* **AASc** *dentro dos estratos*

#### (2,0 pontos) Exerc√≠cio 4.4 (elementos de amostragem)
&lt;img src="img/exerc_4-4_elementos-de-amostragem.png" width="90%" height="90%" style="display: block; margin: auto;" /&gt;

---

##  Exerc√≠cio 5 üèãÔ∏è‚Äç‚ôÄÔ∏è - *Assuma* **AASc** *dentro dos estratos*

####(2.0 pontos) Exerc√≠cio 4.20 (elementos de amostragem)
&lt;img src="img/exerc_4-20_elementos-de-amostragem.png" width="90%" height="90%" style="display: block; margin: auto;" /&gt;

---

## Para casa üè†

* Continuar os Exerc√≠cios e Entregar.

&lt;!-- * Mostrar tamanho de amostra `\(n\)` para AASc dentro dos estratos. --&gt;

&lt;!-- * Continuar exerc√≠cios do livro 'Amostragem: Teoria e Pr√°tica Usando R'    https://amostragemcomr.github.io/livro/estrat.html#exerc11 --&gt;

&lt;!-- * Fazer exerc√≠cios da lista 1. --&gt;

&lt;!-- * Rever os slides. --&gt;

&lt;!-- * Ler BOlfarine e Bussab...da se√ß√£o 11.3 do livro 'Amostragem: Teoria e Pr√°tica Usando R'. --&gt;

## Pr√≥xima aula üìä

* Acompanhar o material no moodle.

&lt;!-- Amostragem Estratificada --&gt;

&lt;!--   + Avalia√ß√£o --&gt;

  &lt;!-- + Exerc√≠cios e Intervalos de confian√ßa --&gt;
  
  &lt;!-- + Laborat√≥rio de <svg aria-hidden="true" role="img" viewBox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:steelblue;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> --&gt;

---

## Boas Festas! üéÖ

&lt;img src="img/image_basu_elephant.jpg" width="20%" height="20%" style="display: block; margin: auto;" /&gt;
.center[
#### Fonte: imagem do livro *Combined Survey Sampling Inference: Weighing of Basu's Elephants*.
]


---

## Refer√™ncias

&lt;!-- Slides baseados no Cap√≠tulo 11 do livro --&gt;

* [Amostragem: Teoria e Pr√°tica Usando o R](https://amostragemcomr.github.io/livro/index.html)

* **Elementos de Amostragem**, Bolfarine e Bussab.

&lt;!-- Cita√ß√µes do Cap√≠tulo --&gt;

&lt;!-- * Neyman(1934) --&gt;

* Cochran(1977)


&lt;!-- * refazer calculos para amostagem aleatoria simples com reposicao --&gt;
&lt;!-- * alocacao... ou lab R comparando aloca√ß√£o proporcional e igual tamanho --&gt;

&lt;!-- listas de exercicios... --&gt;
&lt;!-- dois aspectos da disciplina... ter flexibilidade com teoria... exercitar os conceitos com exercicios teoricos e praticos --&gt;

&lt;!-- falar dos pesos na AES --&gt;

&lt;!-- valor z_alpha/2 significa z ou t --&gt;

&lt;!-- quem tiver interesse em conferir as f√≥rmulas... mostra as conttas, gosta dessa pparte...posso contabilizar ponto extra... tem q ser o primeira... --&gt;
&lt;!-- o mesmo pode valer para os c√≥digos e texto... --&gt;
&lt;!-- fazer o formul√°rio --&gt;
&lt;!-- resumo de formulas --&gt;

---

class: inverse, middle, center

# Solu√ß√£o: 

---

##  Exerc√≠cio 1
#### (2,0 pontos) Revisar exerc√≠cios 1 e 2 com resolu√ß√£o nos slides 'Aula 08'.

Exerc√≠cio 4.1 (Elementos de Amostragem), Itens (c) e (d).


```r
## dados do problema - Exerc√≠cio 4.1 (Elementos de Amostragem)
H &lt;- 5                                    # no. de estratos
h &lt;- 1:H                                  # indice dos estratos
Nh &lt;- c( 117, 98, 74, 41, 45)             # tamanho dos estratos
Ybarrah &lt;- c( 7.3, 6.9, 11.2, 9.1, 9.6)   # media pop. dos estratos
S2h &lt;- c( 1.31, 2.03, 1.13, 1.96, 1.74)   # variancia do estrato 
N &lt;- sum(Nh)                              # tamanho da populacao
n &lt;- 80                                   # tamanho de amostra
```


```
## [1] 8.437867
```

```
## [1] 4.301073
```

```
## [1] 24.960000 20.906667 15.786667  8.746667  9.600000
```

```
## [1] 22.844026 23.819094 13.419060  9.791811 10.126008
```

```
## [1] 22.901909 23.859484 13.419324  9.737872 10.081411
```

---

##  Exerc√≠cio 1


```r
## c.
## na AASc
Varybarra &lt;- Vary / n              # variancia de ybarra sob AASc
Varybarra
```

```
## [1] 0.05376341
```

```r
## AESne sob AAS SEM reposicao dentro dos estratos
Wh &lt;- Nh / N
VarybarraAESnes &lt;- sum( Wh * Sh)^2 / n - sum( Wh * S2h) / N
VarybarraAESnes
```

```
## [1] 0.01532154
```

```r
## AESne sob AAS COM reposicao dentro dos estratos
VarybarraAESnec &lt;- sum( Wh * DPh)^2 / n
VarybarraAESnec
```

```
## [1] 0.01928409
```

```r
## variancias reduzem com alocacao de neyman, vantagem sob ASSs dentro
```

---

##  Exerc√≠cio 1
(c) Sabemos que na **AASc** (ignorando os estratos) a **vari√¢ncia** do **estimador** da **m√©dia** √© dada por
`$$Var_{AASc} (\overline y) = \frac{Var_y}{n} = \frac{4.3010728}{80} = 0.0538.$$`

* J√° na **AESne** considerando **AASs** dentro dos estratos sabemos que
`$$Var_{AES_{ne}} \left( \overline y_{AES} \right) = \frac{1}{n} \left( \sum_{h=1}^{H} W_h S_h \right)^2 - \frac{1}{N} \left( \sum_{h=1}^{H} W_h S_h^2 \right)^2 = \frac{\overline{S}^2}{n} - \frac{\overline{S^2}}{N}.$$`

* E na **AESne** considerando **AASc** dentro dos estratos
`$$Var_{AES_{ne}} \left( \overline y_{AES} \right) = \frac{1}{n} \left( \sum_{h=1}^{H} W_h \sqrt{Var_h} \right)^2 = \frac{\overline{DP}^2}{n}.$$`

As Vari√¢ncias nas estrat√©gias de aloca√ß√£o de Neyman s√£o consideravelmente menores. A vari√¢ncia do estimador da m√©dia no plano **AASc** ignorando os estratos √© cerca de 3,5 vezez a vari√¢ncia assumindo **AESne** sob **AASs**. Se **AASc** dentros dos estratos, esse n√∫mero cai para 2,8. 

---

##  Exerc√≠cio 1


```r
## d.
## na AESpr sob AAS SEM reposicao dentro dos estratos
VarybarraAESprs &lt;- sum(Wh * S2h) * ((1/n) - (1/N))  
VarybarraAESprs
```

```
## [1] 0.01558885
```

```r
## na AESpr sob AAS COM reposicao dentro dos estratos
VarybarraAESprc &lt;- sum(Wh * Varh) / n
VarybarraAESprc
```

```
## [1] 0.019544
```

```r
## variancias um pouco maiores que na alocacao ne neyman, novamente vantagem sob AASs dentro
```

---

##  Exerc√≠cio 1

(d) 

* Para a vari√¢ncia na **AESpr** considerando **AASs** dentro dos estratos sabemos que

`$$Var \left( \overline y_{AES_{pr}} \right) = \left( \frac{1}{n} - \frac{1}{N} \right) \sum_{h=1}^{H} W_h S_h^2$$`

* E para a vari√¢ncia na **AESpr** considerando **AASc** dentro dos estratos

`$$Var \left( \overline y_{AES_{pr}} \right) = \frac{1}{n} \sum_{h=1}^{H} W_h Var_h$$` 

Usando aloca√ß√£o proporcional, a redu√ß√£o nas vari√¢ncias √© muito similar a da aloca√ß√£o de Neyman, com uma pequena vantagem para a √∫ltima.  

---

##  Exerc√≠cio 1

Ex. 11.10 (Amostragem: Teoria e Pr√°tica Usando o R)


```r
## dados do problema - Exerc√≠cio 11.10 (Amostragem: Teoria e Pr√°tica Usando o R)
H &lt;- 3                        # no. de estratos
h &lt;- 1:H                      # indice dos estratos
Nh &lt;- c( 112, 68, 39)         # tamanho dos estratos
S2h &lt;- c( 2.25, 3.24, 3.24)   # variancia do estrato 
Ch &lt;- c( 9, 25, 36)           # custo de amostragem no estrato
N &lt;- sum(Nh)                  # tamanho da populacao
V &lt;- 0.1                      # variancia maxima

## calculo de n
Wh &lt;- Nh / N        # peso do estrato h na pop. 
Sh &lt;- sqrt(S2h)     # variancia do estrato h
raizCh &lt;- sqrt(Ch)  # raiz quadrada do custo no estrato h
num_part1 &lt;- sum( Wh * Sh * raizCh)
num_part2 &lt;- sum( Wh * Sh / raizCh)
denom &lt;- V + sum( Wh * S2h) / N
n &lt;- num_part1 * num_part2 / denom # tamanho da amostra sob AESot e AASs dentro
# n     # arredondar para cima, ceiling(n)
```

---

##  Exerc√≠cio 1

* Para calcular o tamanho total da amostra `\(n\)`, sob aloca√ß√£o √≥tima (*uma vez que o custo de observa√ß√£o das unidades difere de estrato para estrato*),  

  + assumindo **AASs** dentro dos estratos,   
  
  + e definindo a vari√¢ncia da estimativa da m√©dia populacional tal que n√£o ultrapasse `\(V = 0,1\)`

`$$\begin{eqnarray} Var_{AES_{ot}} (\overline y_{AES}) \le 0,1 &amp; \Leftrightarrow &amp; \frac{  \left( \sum_{h=1}^{H} W_h S_{h,y} \sqrt{C_h} \right)\left( \sum_{h=1}^{H} W_h S_{h,y} / \sqrt{C_h} \right) }{0,1 + \frac{1}{N} \sum_{h=1}^{H} W_h S^2_h} \le n \\
&amp; \Leftrightarrow &amp;  \frac{7.0191781 \times 0.4209132}{0.1124826} \le n \\
&amp; \Leftrightarrow &amp;  26.2659638 \le n. \end{eqnarray}$$`

* Arredondaremos `\(n\)` para o n√∫mero inteiro maior e mais pr√≥ximo, ent√£o precisamos de no m√≠nimo `\(n = 27\)` observa√ß√µes para garantir que a vari√¢ncia do estimador da m√©dia n√£o ultrapasse `\(V = 0,1\)`.

---

##  Exerc√≠cio 1


```r
n &lt;- ceiling(n)
nh &lt;- n * (Wh * Sh / raizCh) / sum( Wh * Sh / raizCh) # tamanho da amostra no estrato h
```

* A aloca√ß√£o apropriada para essa amostra, assumindo **AESot** e **AASs** dentro dos estratos, 

`$$n_h = n \times \frac{N_h S_{h,y}}{\sum_{k=1}^{H} N_k S_{k,y}} = (16.4027, 7.1703, 3.427).$$`

*Sob alocacao √≥tima arredondar para o inteiro mais pr√≥ximo nos estratos com menor custo, maior variabilidade, maior tamanho?*

.pull-left[

```r
## arredondando todos para mais
ceiling(nh); sum( ceiling(nh))
```

```
## [1] 17  8  4
```

```
## [1] 29
```
]
.pull-right[

```r
## arredondando inteiro mais proximo
round( nh); sum(round( nh))
```

```
## [1] 16  7  3
```

```
## [1] 26
```
]

---

##  Exerc√≠cio 2
#### (2,0 pontos) Exerc√≠cio 3 dos slides 'Aula 08' modificado.



(a) Utilizando os dados referentes a `\(x\)`, o tamanho de amostra necess√°ria para estimar o n√∫mero total de empregados com um erro m√°ximo admiss√≠vel de 2% e com um n√≠vel de confian√ßa de 95%, supondo aloca√ß√£o de Neyman, na **AASs** dentro do estratos 
`$$n \ge \frac {\sum_{h=1}^{H} \frac {N_h^2 S_{h,x}^2}{w_h}}{V_T +  \sum_{h=1}^{H}{ N_h S_{h,x}^2}}$$`
Denotamos `\(V_T\)` um valor m√°ximo para a vari√¢ncia do estimador do total, ent√£o
`$$r N \overline X = z_\frac{\alpha}{2} \sqrt{Var(\overline T_{AES})} \Leftrightarrow V_T = \frac{r^2 N^2 \overline X^2}{z^2_\frac{\alpha}{2}}.$$`
Temos que 
`$$\overline X = \frac{T_x}{N} = \sum_{h=1}^H T_{h,x} / N = (9020 + 13500 + 17750 + 17329 + 36600 + 14280) / N = 51.1693396,$$`
ent√£o `\(n = 302.\)`

---

##  Exerc√≠cio 2

(b) Conforme os c√°lculos da letra (a) do exerc√≠cio original nos slides da `Aula 08`, a aloca√ß√£o apresenta `\(n_6 &gt; N_6\)`. 

  + Uma solu√ß√£o √© observar todas as unidades do estrato em que `\(n_H \geq N_H\)`.



  + Definindo `\(n_6 = N_6\)`, restam `\(N^* = N - N_6 = 2120 - 20=2100\)` unidades da popula√ß√£o para serem selecionadas e distribu√≠das nos `\(H^*=5\)`.


  
  + O tamanho restante da amostra √© `\(n^* = n - N_6 = 302 - 20=282\)`.
  
  + Sob aloca√ß√£o de Neyman, agora temos `\(n^*_h = n^* \frac{S_h N_h}{\sum_k S_k N_k}\)`, `\(h,k = 1, \ldots, 5\)`. `\(N_h S_{h,x} = \left( 1100\times2.88;500\times10.1;250\times14.39;130\times28.98;120\times86.6 \right)\)` e `\(\sum_{k=1}^5 N_h S_{h,x} = 28862.75.\)` Assim,


```r
nh_novo &lt;- n_novo * (Nh * Shx)[1:5] / sum( (Nh * Shx)[1:5])
(nh &lt;- c( nh_novo, Nh[6]))      # nova alocacao incluindo o ultimo estrato
```

```
## [1]  34.40137  54.83835  39.04534  40.90278 112.81216  20.00000
```

---

##  Exerc√≠cio 2
  
(c) De acordo com o realocamento em (b), uma estimativa pontual do faturamento total √© dada por

`\(t_y = \widehat T_y = \sum_{h=1}^{6} \widehat T_{h,y}  = \sum_{h=1}^{6} N_h \overline y_h = 11003 + 50017 + 25052 + 130170 + 120350 + 207000.\)`


```r
ty &lt;- sum(Nh * ybarrah)                      # estimativa do total
```

2.289\times 10^{5} milhares de reais.

Uma estimativa intervalar para o faturamento total √© dada por (se `\(n = \sum_{h=1}^{H} n_h\)` "for grande"), 

`$$IC ( T_y; 0,95) = \left[ t_y \pm z_{0,05/2} \sqrt{\widehat{Var}_{AES} \left( t_y \right)} \right]$$`

Assumindo (o coeficiente de) confian√ßa `\(1 - \alpha = 95\%\)`, por exemplo, temos o valor da distribui√ß√£o normal padr√£o que deixa √°rea 0,025 √† sua direita dado por `\(z_{0,025} = 1.959964\)`.

---

##  Exerc√≠cio 2

Sob *AASs* dentro dos estratos, temos os estimadores da vari√¢ncia do estimador do total `\(s^2_{h, t_y} = Var_{AES} \left( \widehat T_h \right) = N_h^2 Var_{AES} \left( \overline y_h \right)\)`.

A vari√¢ncia global √© dada por `\(s^2_{t_y} = \widehat{Var} \left( t_y \right) = \sum_{h=1}^6 N_h^2 \left( \frac{1}{n_h} - \frac{1}{N_h} \right) s^2_{h, t_y}\)`


```r
s2ty &lt;- sum( Nh^2 * (1/nh - 1/Nh) *  s2hy)   # estimativa da variancia do estimador do total
s2ty
```

```
## [1] 1593445
```

Assim, temos o erro absoluto, `\(e = z_{0,05} * \sqrt{ s^2_{t_y}}\)` 


```r
e &lt;- -qnorm(0.025) * sqrt(s2ty)   # erro absoluto
e
```

```
## [1] 2474.096
```

---

##  Exerc√≠cio 2

O intervalo ao n√≠vel `\(95\%\)` para `\(T_y\)` √© dado por 


```r
IC &lt;- ty + c(-1, 1) * e          # intervalo de confianca para o total
IC
```

```
## [1] 226425.9 231374.1
```

O intervalo de 226425.9 milhares de reais a 231374.1 milhares de reais deve conter o verdadeiro faturamento total dos estabelecimentos, com uma confian√ßa de `\(95\%\)`. Ou ainda, a cada 100 amostras observadas sob o mesmo plano, espera-se que 95% dos intervalos constru√≠dos com base nessas amostras conter√£o o verdadeiro faturamento total dos estabelecimentos.


---

##  Exerc√≠cio 2

(*B√¥nus*) No item (a), mostrar que tamanho da amostra para m√©dia √© equivalente ao tamanho para o total, usando `\(V\)` e a f√≥rmula de `\(n\)` adequados para cada caso.

* O **tamanho da amostra** `\(n\)` √© o **mesmo** na estima√ß√£o da **m√©dia** e **total**,
  + se usar erro relativo `\(r \overline Y\)` para definir `\(V\)` e usar `\(V \ge Var_{AES} (\overline y)\)`;
  + ou com erro relativo `\(r N \overline Y\)` para definir `\(V_T\)` e usar `\(V_T \ge Var_{AES} (\widehat T)\)`.
  
A vari√¢ncia m√≠nima dos estimador da m√©dia √© dada por `\(V = \frac{r^2 \overline X^2}{z^2_\frac{\alpha}{2}}\)`.


---

##  Exerc√≠cio 3
#### (2,0 pontos) Banco de dados `Lucy`. (arquivo `Aula_AE_xxx.R`)

a. Usando `Zone` como vari√°vel estratificadora, temos o tamanho da popula√ß√£o, bem como a m√©dia e vari√¢ncia populacionais da vari√°vel `Income`, por estrato e globais, 
  


Par√¢metros por estrato


```r
## parametros por estrato
Ybarrah &lt;- tapply( Lucy$Income, Lucy$Zone, mean)      # medias - ou aggregate( Lucy$Income, list(Lucy$Zone), mean)
Varh &lt;- tapply( Lucy$Income, Lucy$Zone, varpop)       # Variancias
cbind( h = 1:H, Nh = Nh, Media = Ybarrah, Variancia =  Varh)
```

```
##   h  Nh    Media Variancia
## A 1 307 652.2834  78955.58
## B 2 727 320.7469  51586.62
## C 3 974 331.0195  23561.77
## D 4 223 684.9821  43597.21
## E 5 165 767.3879  58406.46
```

---

##  Exerc√≠cio 3

Par√¢metros globais


```r
## parametros globais
Ybarra &lt;- mean( Lucy$Income)  # media
# sum( Wh * Ybarrah)          # forma equivalente para caluclar media pop na AES
Ybarra
```

```
## [1] 432.0605
```

```r
Var &lt;-  varpop(Lucy$Income)   # Variancia
Var
```

```
## [1] 71248.14
```

```r
# Vard &lt;- sum( Wh * Varh)                 # Vari√¢ncia dentro
# Vard
# Vare &lt;- sum( Wh * (Ybarrah - Ybarra)^2) # Vari√¢ncia entre
# Vare
# Vare + Vard                             # equivalente ao calculo de varianccia na AES
```
  

---

##  Exerc√≠cio 3

Usando `Level` como vari√°vel estratificadora. temos



Par√¢metros por estrato


```r
## parametros por estrato
Ybarrah2 &lt;- tapply( Lucy$Income, Lucy$Level, mean)      # medias
Varh2 &lt;- tapply( Lucy$Income, Lucy$Level, varpop)       # Variancias
cbind( h = 1:H2, Nh = Nh2, Media = Ybarrah2, Variancia =  Varh2)
```

```
##        h   Nh     Media Variancia
## Big    1   83 1249.4699  63622.27
## Medium 2  737  661.2632  16060.08
## Small  3 1576  281.8274  15132.44
```

Os Par√¢metros globais devem ser os mesmos


```r
## globais
Ybarra &lt;- mean( Lucy$Income)  # media
Ybarra
```

```
## [1] 432.0605
```

```r
# sum( Wh2 * Ybarrah2)          # forma equivalente para caluclar media pop na AES

Var &lt;-  varpop( Lucy$Income)   # Variancia
Var
```

```
## [1] 71248.14
```

```r
# Vard &lt;- sum( Wh2 * Varh2)                 # Vari√¢ncia dentro
# Vard
# Vare &lt;- sum( Wh2 * (Ybarrah2 - Ybarra)^2) # Vari√¢ncia entre
# Vare
# Vare + Vard                             # equivalente ao calculo de varianccia na AES
```

---

##  Exerc√≠cio 3
  
b. Supondo **AASc** de 30 empresas em cada estrato, a vari√¢ncia do estimador da m√©dia de `Income`, utilizando `Zone` como vari√°vel estratificadora,


```r
# Supondo AASc de 30 empresas em cada estrato, vamos calcular a vari√¢ncia do estimador da m√©dia
nh &lt;- rep(30, H)
Varybarrah &lt;- Varh/nh
Varybarrah
```

```
##         A         B         C         D         E 
## 2631.8528 1719.5539  785.3922 1453.2403 1946.8819
```

```r
Varybarra &lt;- sum( Wh^2 * Varybarrah)
Varybarra
```

```
## [1] 353.1272
```

```r
## Ignorando os estratos, a vari√¢ncia do estimador da m√©dia se AASc tradicional de 150 empresasfosse realizada
Var/(30*H)
```

```
## [1] 474.9876
```

---

##  Exerc√≠cio 3

Para `Level` como vari√°vel estratificadora,


```r
# Supondo AASc de 30 empresas em cada estrato, vamos calcular a vari√¢ncia do estimador da m√©dia
nh2 &lt;- rep(30, H2)
Varybarrah2 &lt;- Varh2/nh2
Varybarrah2
```

```
##       Big    Medium     Small 
## 2120.7424  535.3359  504.4148
```

```r
Varybarra2 &lt;- sum( Wh2^2 * Varybarrah2)
Varybarra2
```

```
## [1] 271.432
```

```r
## Ignorando os estratos, a vari√¢ncia do estimador da m√©dia se AASc tradicional de 90 empresasfosse realizada
Var/90
```

```
## [1] 791.646
```

---

##  Exerc√≠cio 3

c. Se olharmos diretamente para as vari√¢ncias dos estimadores, usando `\(n_h = 30\)` paratodos os estratos, para ambas as vari√°veis estratificadoras, temos

Vari√°vel estratificadora | `\(Var_{AES} \left( \overline y \right)\)` | `\(n\)` 
--|:--:|:--:
`Zone`  | 353.1272237 | 150
`Level` | 271.4319711 | 90

A compara√ß√£o das vari√¢ncias pode n√£o parecer justa √† primeira vista, pois fixando `\(n_h = 30\)` sendo que a vari√°vel `Zone` possui `\(H=5\)` estratos e `Level` `\(H = 3\)`. Mas ainda, usando `\(n_h = 50\)` para `Level` a `\(Var_{AES} \left( \overline y \right)\)` diminuiria.

Olhando para os **EPA**s para ambas as vari√°veis estratificadoras temos

Vari√°vel estratificadora | `\(Var_{AASc} \left( \overline y \right) = \frac{Var_y}{n}\)` | `\(EPA = \frac{Var_{AES} \left( \overline y \right)}{Var_{AASc} \left( \overline y \right)}\)` 
--|:--:|:--:
`Zone`  | `\(\frac{7.1248141\times 10^{4}}{150} = 474.9876077\)` | `\(0.7434451\)`
`Level` | `\(\frac{7.1248141\times 10^{4}}{90} = 791.6460129\)` | `\(0.3428704\)`

---

##  Exerc√≠cio 3
  
d. Usando a vari√°vel `Level` como estratificadora, selecionamos uma amostra de tamanho `\(n=90\)` de igual tamanho entre os `\(H=3\)` estratos.


```r
set.seed(02036)
nh &lt;- 30
s &lt;- tapply( Lucy$ID, Lucy$Level, sample, size=nh)             # IDs selecionados para a amostra
Lucy_amostra &lt;- Lucy[Lucy$ID %in% unlist(s), c("Level","Income")]   # banco de dados amostral          
```
Ou podemos usar a fun√ß√£o... do pacote... . 

Com a amostra observada, calculamos os valores por estrato 


```r
## estimativas por estrato
ybarrah &lt;- tapply( Lucy_amostra$Income, Lucy_amostra$Level, mean)   # medias amostrais
varh &lt;- tapply( Lucy_amostra$Income, Lucy_amostra$Level, varpop)    # Variancias amostrais
cbind( h = 1:H2, Nh = Nh2, nh = nh, ybarra = ybarrah, varh =  varh)
```

```
##        h   Nh nh   ybarra     varh
## Big    1   83 30 1254.367 88396.30
## Medium 2  737 30  659.700 18700.74
## Small  3 1576 30  263.300 16775.41
```

```r
## estimativas globais
ybarra &lt;- sum( Wh2 * ybarrah)
var_ybarra &lt;- (1/nh) * sum( Wh2^2 * varh)
```

---

##  Exerc√≠cio 3

Uma estimativa do lucro m√©dio das companhias, no particular ano fiscal, √© aproximadamente 

`$$\begin{eqnarray} \overline y &amp; = &amp; \sum_{h=1}^3 W_h \overline y_h \\
 &amp; = &amp; 0.03 \times 1254.37 + 0.31 \times 659.7 + 0.66 \times 263.3 \\
 &amp; = &amp; 419.56 \text{reais}.
\end{eqnarray}$$`

Utilizando **AASc** dentro dos estratos, a **estimativa da vari√¢ncia da m√©dia amostral** √© dada por 

`$$\begin{eqnarray} Var_{AES} \left( \overline y \right) &amp; = &amp; \frac{1}{k} \sum_{h=1}^3 W_h^2 Var_h \\ 
 &amp; = &amp; \frac{1}{30} \left( 0 \times 63622.27 + 0.09 \times 16060.08 + 0.43 \times 15132.44 \right) \\
 &amp; = &amp; 304.45.
\end{eqnarray}$$`

---

##  Exerc√≠cio 3

Por fim, uma estimativa intervalar para o lucro m√©dio das companhias, com 95% de confian√ßa (se `\(n = \sum_{h=1}^{H} n_h\)` "for grande") √© dado por 

`$$IC ( \overline y; 0,95) = \left[ \overline y \pm z_{0,05/2} \sqrt{\widehat{Var}_{AES} \left( \overline y \right)} \right]$$`

Assumindo (o coeficiente de) confian√ßa `\(1 - \alpha = 95\%\)`, por exemplo, temos o valor da distribui√ß√£o normal padr√£o que deixa √°rea 0,025 √† sua direita dado por `\(z_{0,025} = 1.959964\)`. Assim, o erro absoluto, `\(e = z_{0,05} * \sqrt{ s^2_{\overline y}}\)`  √© aproximadamente


```r
e &lt;- -qnorm(0.025) * sqrt(var_ybarra)   # erro absoluto
e
```

```
## [1] 34.19818
```

E o intervalo ao n√≠vel `\(95\%\)` para `\(\overline y\)` √© dado por 


```r
IC &lt;- ybarra + c(-1, 1) * e          # intervalo de confianca para a media
IC
```

```
## [1] 385.3645 453.7608
```

---

##  Exerc√≠cio 3

O intervalo de 385.36 d√≥lares a 453.76 d√≥lares deve conter o verdadeiro lucro m√©dio da companhias, no ano fiscal estudado, com uma confian√ßa de `\(95\%\)`. Ou ainda, a cada 100 amostras observadas sob o mesmo plano, espera-se que em `\(95%\)` dos intervalos constru√≠dos com base nessas amostras conter√£o o verdadeiro lucro m√©dio das companhias.

*(b√¥nus)*: Adicionar comandos para obter total de `Income`.
  
*(b√¥nus 2)*: Adicionar comandos para obter propor√ß√£o de `SPAM`.

---

##  Exerc√≠cio 4
#### (2,0 pontos) Exerc√≠cio 4.4 (elementos de amostragem)



a. Para estimar uma propor√ß√£o de fam√≠lias que possume conta em caderneta de poupan√ßa, com erro padr√£o da estimativa de no m√°ximo 0,02, definimos `\(V_P \geq Var_{AES} \left( \widehat P_{AES} \right)\)`.

Lembrando erro padr√£o: `\(EP \left( \widehat P \right) = \sqrt{ Var \left( \widehat P \right)} = DP \left( \widehat P_{AES} \right)\)`.

Assumindo **AASc** dentro dos estrtos, e custo de amostragem constante, o tamanho amostral m√≠nimo para assegurarmos uma vari√¢ncia da estimativa da propor√ß√£o menor ou igual a `\(V_P = \left[ EP \left( \widehat P_{AES} \right) \right]^2\)` √© dado por

`$$\begin{eqnarray} n &amp; \ge &amp; \frac{ \left( \sum_{h=1}^{H} W_h \sqrt{P_h (1-P_h)} \right)^2 }{V_P} = \frac{ \left( \sum_{h=1}^{H} W_h \sqrt{P_h (1-P_h)} \right)^2 }{\left[ EP \left( \widehat P_{AES} \right) \right]^2} \\
 &amp; = &amp; \frac{ 0.6 \times 0.4 + 0.3 \times 0.49 + 0.1 \times 0.49}{(0,02)^2} = 475.15 \end{eqnarray}$$`

---

##  Exerc√≠cio 4

A parti√ß√£o √≥tima com custo constante, parti√ß√£o de Neyman, nesse caso (**AASc** dentro) pode ser dada por 
`$$n_h = n \times \frac{w_h \times \sqrt{P_h (1-P_h)}}{\sum_k w_k \times \sqrt{P_k (1-P_k)}} = \left( 261.58, 160.18, 53.39 \right).$$`

b. Para estimar a quantidade m√©dia, com custo constante, sabemos que 
`$$n \ge \frac{ \left( \sum_{h=1}^{H} W_h DP_{h,y} \right)^2 }{V}.$$`

Fixando o erro padr√£o m√°ximo da estimativa da m√©dia em 2 *reais*, temos `\(V = 4reais^2\)`, assim 
`$$n \ge \frac{ 0.6 \times 9 + 0.3 \times 18 + 0.1 \times 52}{2^2} = 64.$$` 

E a parti√ß√£o dada por
`$$n_h = n \times \frac{w_h \times DP_h}{\sum_k w_k \times DP_k} = \left( 21.6, 21.6, 20.8 \right)$$`

Interpreta√ß√£o e conclus√£o: N√£o havendo restri√ß√£o de or√ßamento na pesquisa, optamos por observar o maior dos tamanhos amostrais pois garantimos que o erro padr√£o da estimativa n√£o ultrapasse o valor m√°ximo estipulado. Nesse caso, a estimativa para o par√¢metro que resultou em menor tamanho amostral ter√° seu erro pedr√°o provavelmente menor ainda do que o estipulado.

---

##  Exerc√≠cio 5



Uma estimativa pontual da propor√ß√£o de contas problem√°ticas `\(\widehat P_{AES}\)` √© dada por 

`$$\begin{eqnarray} \widehat P &amp; = &amp; \sum_{h=1}^4 W_h p_h \\
 &amp; = &amp; 0.26 \times 0.3 + 0.17 \times 0.2 + 0.43 \times 0.4 + 0.13 \times 0.1 \\
 &amp; = &amp; 0.3.
\end{eqnarray}$$`
Ou seja, estimamos que a propor√ß√£o de contas problem√°ticas da rede de lojas seja aproximadamente 30%.

Utilizando **AASc** dentro dos estratos, a **estimativa da vari√¢ncia da propor√ß√£o amostral** √© dada por 

`$$\begin{eqnarray} Var_{AES} \left( p \right) &amp; = &amp; \frac{1}{k} \sum_{h=1}^4 W_h^2 p_h (1-p_h) \\ 
 &amp; = &amp; \frac{1}{15, 10, 20, 6} \left( 0.07 \times 0.21 + 0.03 \times 0.16 + 0.19 \times 0.24 + 0.02 \times 0.09 \right) \\
 &amp; = &amp; 0.0043.
\end{eqnarray}$$`

---

##  Exerc√≠cio 5

Por fim, uma estimativa intervalar para a propor√ß√£o de contas problem√°ticas, com 95% de confian√ßa (se `\(n = \sum_{h=1}^{H} n_h\)` "for grande") √© dado por 

`$$IC ( P; 0,95) = \left[ p \pm z_{0,05/2} \sqrt{\widehat{Var}_{AES} \left( p \right)} \right]$$`

Assumindo (o coeficiente de) confian√ßa `\(1 - \alpha = 95\%\)`, por exemplo, temos o valor da distribui√ß√£o normal padr√£o que deixa √°rea 0,025 √† sua direita dado por `\(z_{0,025} = 1.959964\)`. Assim, o erro absoluto, `\(e = z_{0,05} * \sqrt{ s^2_p}\)`  √© aproximadamente


```r
e &lt;- -qnorm(0.025) * sqrt(var_p)   # erro absoluto
e
```

```
## [1] 0.1278124
```

E o intervalo ao n√≠vel `\(95\%\)` para `\(\overline y\)` √© dado por 


```r
IC &lt;- p + c(-1, 1) * e          # intervalo de confianca para a media
IC
```

```
## [1] 0.1721876 0.4278124
```

---

##  Exerc√≠cio 5

O intervalo de 0.17 a 0.43 deve conter a verdadeira propor√ß√£o de contas problem√°ticas dessa rede, com uma confian√ßa de `\(95\%\)`. Ou ainda, a cada 100 amostras observadas sob o mesmo plano, espera-se que em `\(95%\)` dos intervalos constru√≠dos com base nessas amostras conter√£o a verdadeira propor√ß√£o de contas problem√°ticas.

---

class: inverse, middle, center

# Pontua√ß√£o e Coment√°rios 

---

## Pontua√ß√£o
### Avalia√ß√£o parcial 1
#### Exerc√≠cio 1: (2,0 pontos)
* Ex. 4.1 (Elementos de Amostragem),  
	a. (0,8 pontos) Itens (c) e (d).  
	b. (0,2 pontos) Interprete os resultados.

* Ex. 11.10 (Amostragem: Teoria e Pr√°tica Usando o R)  
	a. (0,1 pontos) Informa√ß√µes do enunciado.  
	b. (0,2 pontos) Indicar f√≥rmulas.  
	c. (0,6 pontos) C√°lculo de n e n_h.  
	d. (0,1 pontos) Interpreta√ß√£o.

#### Exerc√≠cio 2: (2,0 pontos)
a. (0,6 pontos) C√°lculo n e nh conferir.  
b. (0,7 pontos) Coment√°rios e realoca√ß√£o.  
c. (0,7 pontos) Estima√ß√£o pontual, por intervalo e interpreta√ß√£o.  
d. (*0,5 pontos b√¥nus)

---

## Pontua√ß√£o
### Avalia√ß√£o parcial 1
#### Exerc√≠cio 3: (2,0 pontos)  
a. (0,4 pontos) Par√¢metros por `Zone` e `Level`.  
b. (0,6 pontos) Vari√¢ncia do estimador da m√©dia por `Zone` e `Level`.  
c. (0,2 pontos) Compara√ß√£o.  
d. (0,8 pontos) Sele√ß√£o da amostra, estima√ß√£o e interpreta√ß√µes.  
e. (*0,2 pontos b√¥nus1)  
f. (*0,3 pontos b√¥nus2)  

#### Exerc√≠cio 4: (2,0 pontos)  
a. (0,9 pontos) C√°lculos e Interpreta√ß√£o  
b. (0,9 pontos) C√°lculos e Interpreta√ß√£o  
c. (0,2 pontos) Conclus√£o

#### Exerc√≠cio 5: (2,0 pontos)  
a. (1,0 pontos) Estimativa pontual e interpreta√ß√£o  
b. (1,0 pontos) Estimativa intervalo e interpreta√ß√£o

---

## Pontua√ß√£o
### Atividade Aula 08
#### Exerc√≠cio 1:
* a. Nos slides *Aula 06*, p√°gina 8, continuar √≠tens (c) e (d).  
* Interprete os resultados.  
* Arredondamento.

#### Exerc√≠cio 2: Exerc√≠cio 11.10 (Amostragem: Teoria e Pr√°tica Usando o R)
* Informa√ß√µes do enunciado.  
* Indicar f√≥rmula.  
* C√°lculo de n.  
* Conclus√°o... "tamanho m√≠nimo"

#### Exerc√≠cio 3: Exerc√≠cio 11.7 (Amostragem: Teoria e Pr√°tica Usando o R)
* a. Express√µes, c√°lculo e interpreta√ß√£o.  
* b. Express√µes, c√°lculo e interpreta√ß√£o.

---

## Comentarios gerais
* Enviar o output `.pdf`, com imagens da resolu√ß√£o `√† m√£o` ou os resultados da vers√£o `em c√≥digos`
* Se os c√≥digos est√£o em arquivo `.R`, enviar f√≥rmulas em separado
* Se enviar c√≥digo com erro deixar claro onde est√° o erro... o ideal seria deixar as linhas com erro comentadas 
* Colocar nome nos arquivos, nos c√≥digos e outputs tamb√©m.
* F√≥rmulas/express√µes devem aparecer, seja no formato `√† m√£o` ou `em c√≥digos`... se enviar somente pdf... enviar arquivo de codigos tambem
* Interpreta√ß√µes... Pontual... qual o par√¢metro em termos do problema, unidade de medida... ou IC parametro, unidade de medida, confianca... Resultado e Conclus√£o: O IC(), com alfa; Portanto, com 95%...
	+ " estimamos que a m√©dia esteja entre 406,16 e 167,84 com 95% de confian√ßa." ... "o total esta em ic de 95% de confian√ßa entre 187184.3 e 192095.7" est√° correto:
	+ suposi√ß√µes para ICs...
F√≥rmulas... 
c√≥digos... se pegamos de outros, cuidado para n√£o deixar c√≥digo desnecess√°rio... manter organizados os c√≥digos...
Entrega... relatorio bem apresentado... "Marcia falou sobre relatorio e markdown"... capricho com relatorios
Se nao fez a atividade "Aula 08" conferiu os codigos... odnde estao... tua versao dos codigos... semente nao aleatoria, nos caso de selecionar amostra cada um poderia ter uma amostra diferente... 

---

## Comentarios gerais
* Para evitar o `for()` 
	+ calcular somas de vetores... x &lt;- 1; for{x &lt;- x + 1}
	+ calcular medidas agregadas `tapply()` faz o mesmo, ou `aggregate()`.
* Arredondamentos: `\(n\)` `ceiling()` e `\(n_h\)` `round()`
* C√°lculo do deff incorreto (usando amostra???), selecionando amostra e usando `svymean`. (-0,2 pontos)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
