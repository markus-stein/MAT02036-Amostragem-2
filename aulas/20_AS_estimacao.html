<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>MAT02036 - Amostragem 2</title>
    <meta charset="utf-8" />
    <meta name="author" content="Markus Stein" />
    <script src="libs/header-attrs-2.18/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, title-slide

.title[
# MAT02036 - Amostragem 2
]
.subtitle[
## Aula 20 - Amostragem Sistem√°tica - Par√¢metros e Estima√ß√£o
]
.author[
### Markus Stein
]
.institute[
### Departamento de Estat√≠stica, IME/UFRGS
]
.date[
### 2022/2
]

---




<div>
<style type="text/css">.xaringan-extra-logo {
width: 110px;
height: 128px;
z-index: 0;
background-image: url(C:/Users/User/Documents/MAT02036-Amostragem-2/img/logo_dest.png);
background-size: contain;
background-repeat: no-repeat;
position: absolute;
top:1em;right:1em;
}
</style>
<script>(function () {
  let tries = 0
  function addLogo () {
    if (typeof slideshow === 'undefined') {
      tries += 1
      if (tries < 10) {
        setTimeout(addLogo, 100)
      }
    } else {
      document.querySelectorAll('.remark-slide-content:not(.title-slide):not(.inverse):not(.hide_logo)')
        .forEach(function (slide) {
          const logo = document.createElement('div')
          logo.classList = 'xaringan-extra-logo'
          logo.href = null
          slide.appendChild(logo)
        })
    }
  }
  document.addEventListener('DOMContentLoaded', addLogo)
})()</script>
</div>

### *Housekeeping*

* Aproveitem o momento presencial para tirar d√∫vidas

* Se estiv√©ssemos no ensino remoto ou √† dist√¢ncia

  + voc√™s poderiam estar somente ouvindo, sem intera√ß√£o
  
  + ou assistindo v√≠deos e material em outro momento
  
* Depois das aulas, rever material da aula passada

  + fazer exerc√≠cios
  
  + se preparar para a pr√≥xima aula

---

## Aula passada üíæ
### Amostragem Sistem√°tica Simples

* *O m√©todo*: selecionar cada `\(K\)`-√©sima unidade da popula√ß√£o; 
  + `\(N\)` - tamanho da popula√ß√£o; `$$N = nK+c, \: \: \: \text{0 \leq c &lt; K}$$`
  + `\(K\)` - **intervalo de sela√ß√£o**;
  + `\(n = \lfloor N/K \rfloor\)` tamanho da amostra;
  + `\(c\)` - √© o resto da divis√£o `\(N/K\)`;
  + `\(r\)` - **valor inicial**, n√∫mero inteiro de `\(1\)` a `\(K\)`, `$$r \sim Uniforme-Discreta(K);$$`

* Na **AS** a amostra `\(s_r = \{ i : i = r + l K \leq N; \,\,\, l = 0, \ldots, n \},\)` satisfaz   
`$$p(s) = \left\{ \begin{array}{ll} 1/K, \, \text{se} \,\,\, s=s_r \,\,\text{para} \,\,r=1,\,\,\,2,\,\,\,...,\,\,\,K \\ 0, \,\,\, \textrm{caso contr√°rio}   \end{array} \right.$$`

---

## Aula passada üíΩ
### Amostragem Sistem√°tica Simples

* A probabilidade de inclus√£o na amostra de uma unidade `\(i\)` qualquer √© dada por:
`$$\pi_i=\frac1K,\,\,i=1,\,\dots,\,\,N$$`

* A probabilidade de inclus√£o das unidades `\(i \ne j\)` na amostra √© dada por:
`$$\pi_{ij}=\left\{\begin{array}{ll} 1/K, \,\,\textrm{se }i \ne j \,\in s_r\,\,\,\text{para}\,\,\  r=1,\,\dots,\,K\\\ 0,\,\,\, \textrm{caso contr√°rio} \end{array}\right.\,\,\,$$`

* As vari√°veis indicadoras associadas √†s amostras poss√≠veis `\(s_r\)`:
`$$I(r)=\left\{\begin{array}{ll} 1,\,\,\textrm{se a amostra √©}\,s_r\,\ \textrm {para}\,\,1\le r\le K \\ 0,\,\, \textrm{caso contr√°rio} \end{array}\right.\,\,\,$$`

* O valor esperado de `\(I(r)\)` √©
`$$E_{AS}[I(r)]=1/K\,,\,\,r=1,\,\dots,\,K,$$`
a vari√¢ncia
`$$Var_{AS}[I(r)]=E_{AS}\{[I(r)]^2\}-\{E_{AS}[I(r)]\}^2=\frac1{K}-\frac1{K^2}=\frac{1}{K}\left(1-\frac{1}{K}\right)$$`

e a covari√¢ncia entre `\(I(r)\)` e `\(I(q)\)` quando `\(r \ne q\)` √©:
`$$Cov_{AS}[I(r),I(q)]=E_{AS}[I(r)I(q)]-E_{AS}[I(r)]E_{AS}[I(r)]=0-\frac{1}{K^2}=-\frac{1}{K^2}$$`
j√° que apenas uma das duas partidas `\(r\)` ou `\(q\)` pode ser selecionada.

---

class: inverse, middle, center

# Estima√ß√£o

---

## Amostragem Sistem√°tica Simples
### Estima√ß√£o de totais na **AS**

* O estimador tipo Horvitz-Thompson do total sob **AS**, 
  + o peso amostral das unidades da amostra √© sempre igual a `\(d_i = 1 / \pi_i = K\)`, ent√£o
`$$\widehat{T}_{AS} = K t_r = K \sum_{i \in s_r} y_i$$`
em que `\(t_r = \sum_{i \in s_r} y_i\)` √© a soma amostral dos valores observados da vari√°vel `\(y\)`.

* J√° sabemos que este estimador √© n√£o viciado para o total populacional. 
`$$\begin{array}{ll}
E_{AS}(\widehat{T}_{AS}) &amp; = E_{AS} \left[ K t_r \right] = K E_{AS} \left[ \sum_{r=1}^{K} I(r) t_r \right] \\ &amp; = K \sum_{r=1}^{K}E_{AS} \left [I(r) \right] t_r = K \sum_{r=1}^{K} \frac{1}{K} t_r = \sum_{r=1}^{K} t_r = T
\end{array}$$`

---

## Amostragem Sistem√°tica Simples
### Estima√ß√£o de totais na **AS**

#### Exemplo
Considere a popula√ß√£o composta de `\(N=19\)` unidades, cujos dados da vari√°vel de interesse `\(y\)`, da qual se deseja retirar uma amostra sistem√°tica simples com intervalo de sele√ß√£o com `\(K=4\)` para estimar o total populacional. Verifique numericamente que o estimador `\(\widehat Y_{AS}\)` √© n√£o viciado.

`\(s_1\)` | `\(s_2\)` |	`\(s_3\)` | `\(s_4\)`
--|--|--|-- 
99  |  54 |	 96 |   54
85  |  88	|  55 |   83
62  |  85	|  96 |   55
91  |  92	|  67 |   68
54  |  79	|  76 |   

Para mostrar que o estimador √© n√£o viciado, basta verificar que a m√©dia dos seus valores poss√≠veis √© igual ao par√¢metro populacional a ser estimado.

---

## Amostragem Sistem√°tica Simples
### Estima√ß√£o de totais na **AS**



```r
K=4     # Intervalo de sele√ß√£o        #print(paste("Intervalo de sele√ß√£o K:", K), quote=FALSE)
pop=matrix(c(99,54,96,54,85,88,55,83,62,85,96,55,91,92,67,68,54,79,76,NA),5,K,byrow=T) # Carregando os valores populacionais da vari√°vel y
## Calculando a estimativa do total para cada uma das AS poss√≠veis
Yhatr=NULL
for(l in (1:K)) Yhatr[l] = K*sum(pop[,l],na.rm=T)
EYhat=mean(Yhatr)    # Calculando a m√©dia das estimativas de total
EYhat
```

```
## [1] 1439
```

```r
## Calculando o total populacional Y
Y=sum(pop,na.rm=T)
Y
```

```
## [1] 1439
```


---

## Amostragem Sistem√°tica Simples
### Estima√ß√£o de m√©dias na **AS**

A m√©dia populacional `\(\overline Y=Y/N\)` pode ser vista como uma raz√£o entre o total da vari√°vel `\(y\)` e o total de unidades populacionais:
$$
\overline Y = \frac Y N = \displaystyle \frac {\sum_{r=1}^{K} t_r} {\sum_{r=1}^{K} n_r}
$$
Para estim√°-la deve-se considerar duas situa√ß√µes: quando o tamanho `\(N\)` da popula√ß√£o √© conhecido, ou quando esse valor √© desconhecido. Um estimador n√£o viciado para a m√©dia quando `\(N\)` √© conhecido √© dado por: 

$$
\overline y_{AS} = \frac {\widehat Y_{AS}} N = \frac {K t_r}{N}  (\#eq:eqsis4)
$$ 
Este estimador √© n√£o viciado para `\(\overline Y\)`, pois foi visto que `\(\widehat Y_{AS}\)` √© n√£o viciado para o total populacional `\(Y\)`. Tamb√©m √© interessante observar que este estimador n√£o √© igual √† m√©dia amostral, a menos no caso em que `\(N = nK\)`.

**(#exm:exmsis6)** Considerando a mesma popula√ß√£o do Exemplo \@ref(exm:exmsis5), pode-se verificar que `\(\overline y_{AS}\)` √© n√£o viciado para a m√©dia populacional `\(\overline Y\)`. Neste caso, basta calcular a estimativa da m√©dia para cada coluna (amostra sistem√°tica poss√≠vel) da Tabela \@ref(tab:tabsis2), calcular o valor m√©dio das estimativas e comparar com m√©dia populacional. Pode-se utilizar o R para realizar a tarefa.


```r
# Alterando o separador de decimais para v√≠rgula
options(OutDec=",")
# Intervalo de sele√ß√£o e tamanho da popula√ß√£o conhecido
K=4
print(paste("Intervalo de sele√ß√£o K:", K), quote=FALSE)
```

```
## [1] Intervalo de sele√ß√£o K: 4
```

```r
# Carregando os valores populacionais da vari√°vel y
pop=matrix(c(99,54,96,54,85,88,55,83,62,85,96,55,91,92,67,68,54,79,76,NA),5,K,byrow=T)
print("Dados populacionais", quote=FALSE)
```

```
## [1] Dados populacionais
```

```r
print(pop)
```

```
##      [,1] [,2] [,3] [,4]
## [1,]   99   54   96   54
## [2,]   85   88   55   83
## [3,]   62   85   96   55
## [4,]   91   92   67   68
## [5,]   54   79   76   NA
```

```r
# Calcula tamanho da popula√ß√£o
N=sum(!is.na(pop))
print(paste("Tamanho da popula√ß√£o N:", N), quote=FALSE)
```

```
## [1] Tamanho da popula√ß√£o N: 19
```

```r
# Calculando a estimativa da m√©dia para cada uma das AS poss√≠veis
ybarAS.r=NULL
for(i in (1:K)) ybarAS.r[i] = K*sum(pop[,i],na.rm=T)/N
print("Valores poss√≠veis do estimador n√£o viciado da m√©dia", quote=FALSE)
```

```
## [1] Valores poss√≠veis do estimador n√£o viciado da m√©dia
```

```r
print(ybarAS.r)
```

```
## [1] 82,31579 83,78947 82,10526 54,73684
```

```r
# Calculando a m√©dia das estimativas
EybarAS=mean(ybarAS.r)
print(paste("M√©dia das estimativas poss√≠veis da m√©dia:", EybarAS), quote=FALSE)
```

```
## [1] M√©dia das estimativas poss√≠veis da m√©dia: 75,7368421052632
```

```r
# Calculando a m√©dia populacional
Ybar=mean(pop,na.rm=T)
print(paste("M√©dia populacional:", Ybar), quote=FALSE)
```

```
## [1] M√©dia populacional: 75,7368421052632
```

```r
# Alterando o separador de decimais para ponto
options(OutDec=".")
```

**(#exm:exmsis7)** Utilizando a mesma popula√ß√£o, pode-se verificar que o estimador da  m√©dia amostral simples `\((\overline y)\)` para a m√©dia populacional de `\(y\)` n√£o coincide com o estimador `\(\overline y_{AS}\)` e, al√©m disso, √© viciado.


```r
# Alterando o separador de decimais para v√≠rgula
options(OutDec=",")
# Intervalo de sele√ß√£o e tamanho da popula√ß√£o conhecido
K=4
# Carregando os valores populacionais da vari√°vel y
pop=matrix(c(99,54,96,54,85,88,55,83,62,85,96,55,91,92,67,68,54,79,76,NA),5,K,byrow=T)
# Calculando a m√©dia amostral simples para cada uma das AS poss√≠veis
ybar.r=NULL
for(i in (1:K)) ybar.r[i] = mean(pop[,i],na.rm=T)
ybar.r
```

```
## [1] 78,2 79,6 78,0 65,0
```

```r
# Calculando a m√©dia das estimativas
Eybar=mean(ybar.r)
print(paste("M√©dia das estimativas poss√≠veis da m√©dia:", Eybar), quote=FALSE)
```

```
## [1] M√©dia das estimativas poss√≠veis da m√©dia: 75,2
```

```r
# Alterando o separador de decimais para ponto
options(OutDec=".")
```

Quando `\(N\)` √© desconhecido, um estimador alternativo para a m√©dia √© dado pela raz√£o entre os estimadores do total e do tamanho populacionais: 

$$
\overline y_{AS}=\frac {\widehat Y_{AS}}{\widehat N_{AS}}=\frac {Kt_r}{Kn_r}=\frac {t_r}{n_r}=\overline y_r=\overline y(\#eq:eqsis5)
$$ 
que √© a m√©dia amostral.

Verifica-se assim que a m√©dia amostral simples √© um estimador para uma raz√£o, sendo portanto viciado para estimar a m√©dia populacional. Tal estimador s√≥ ser√° exatamente n√£o viciado quando `\(N=nK\)`, pois:

$$
\begin{align} E_{AS}(\overline{y}_{AS})&amp;=  E_{AS}(\overline y)= E_{AS} \left[\sum_{r=1} ^{K}I(r) \overline y_r \right] \\ &amp;= \frac{1}{K} \sum_{r=1}^{K}\overline y_r = \frac{1}{K} \sum_{r=1}^{K}\frac {t_r}{n_r} \\&amp;\neq \frac {\sum_{r=1}^{K}t_r} {\sum_{r=1}^{K}n_r} = \overline Y \end{align}
$$

O v√≠cio desse estimador (quando `\(N \ne nK\)`) √© o pre√ßo pago quando n√£o se conhece o tamanho `\(N\)` da popula√ß√£o!

## Estima√ß√£o de uma propor√ß√£o na amostragem sistem√°tica simples

Como j√° foi visto no Cap√≠tulo \@ref(proporc), muitas vezes o interesse √© estimar a propor√ß√£o de unidades da popula√ß√£o que possuem uma determinada caracter√≠stica de interesse. Nesse caso, para as unidades com a caracter√≠stica de interesse presente, a vari√°vel `\(y\)` recebe o valor `\(1\)` e para as demais unidades, `\(y\)` recebe o valor `\(0\)`.

Como j√° foi visto que a propor√ß√£o equivale √† m√©dia de uma vari√°vel do tipo indicadora, quando o tamanho total da popula√ß√£o, `\(N\)`, for conhecido um estimador n√£o viciado para a propor√ß√£o √© dado por:

$$
\widehat p_{AS} = \frac K N \sum_{i \in s_r} y_i = \frac K N t_r = \frac K N n_a (\#eq:eqsis6)
$$
onde `\(n_a\)` denota o n√∫mero de unidades na amostra que t√™m a caracter√≠stica de interesse.

**(#exm:exmsis8)** Utilizando o R pode-se ver numericamente que o estimador `\(\widehat p_{AS}\)` para a propor√ß√£o `\(p\)` √© n√£o viciado quando `\(N\)` √© conhecido.


```r
# Alterando o separador de decimais para v√≠rgula
options(OutDec=",")
# Intervalo de sele√ß√£o e tamanho da popula√ß√£o conhecido
K=4
print(paste("Intervalo de sele√ß√£o K:", K), quote=FALSE)
```

```
## [1] Intervalo de sele√ß√£o K: 4
```

```r
# Carregando os valores populacionais da vari√°vel y
(pop=matrix(c(0,1,0,1,1,1,0,0,0,0,1,0,0,0,1,1,1,0,1,NA),5,K,byrow=T))
```

```
##      [,1] [,2] [,3] [,4]
## [1,]    0    1    0    1
## [2,]    1    1    0    0
## [3,]    0    0    1    0
## [4,]    0    0    1    1
## [5,]    1    0    1   NA
```

```r
# Calcula tamanho da popula√ß√£o
N=sum(!is.na(pop))
print(paste("Tamanho da popula√ß√£o N:", N), quote=FALSE)
```

```
## [1] Tamanho da popula√ß√£o N: 19
```

```r
# Calcula estimativas da propor√ß√£o para cada uma das AS poss√≠veis
p_AS=NULL
for(i in (1:K)) p_AS[i] = K*sum(pop[,i],na.rm=T)/N
print("Valores poss√≠veis do estimador n√£o viciado da propor√ß√£o", quote=FALSE)
```

```
## [1] Valores poss√≠veis do estimador n√£o viciado da propor√ß√£o
```

```r
print(p_AS)
```

```
## [1] 0,4210526 0,4210526 0,6315789 0,4210526
```

```r
# Calculando a m√©dia das estimativas
Ep_AS=mean(p_AS)
print(paste("M√©dia das estimativas poss√≠veis da propor√ß√£o:", Ep_AS), quote=FALSE)
```

```
## [1] M√©dia das estimativas poss√≠veis da propor√ß√£o: 0,473684210526316
```

```r
# Calculando propor√ß√£o populacional p
p=mean(pop,na.rm=TRUE)
print(paste("Propor√ß√£o na popula√ß√£o p:", p), quote=FALSE)
```

```
## [1] Propor√ß√£o na popula√ß√£o p: 0,473684210526316
```

```r
# Alterando o separador de decimais para ponto
options(OutDec=".")
```

No caso em que o tamanho `\(N\)` da popula√ß√£o √© desconhecido, pode-se utilizar o estimador tipo raz√£o que, nesse caso, √© igual √† propor√ß√£o amostral:
$$
\widehat p_{AS} = \frac {n_a} {n_r}
$$
Este estimador √© viciado, a menos que `\(N=nK\)`, como j√° foi visto.


## Vari√¢ncia dos estimadores sob amostragem sistem√°tica simples

A vari√¢ncia de `\(\widehat Y_{AS}\)` sob amostragem sistem√°tica simples √© dada por: 

$$
\begin{array}{ll}\hspace{-0,6cm}
V_{AS}(\widehat{Y}_{AS})&amp;=&amp;V_{AS}\left[K\sum_{r=1}^{K}I(r)t_r\right]\\&amp;=&amp;K^2\left[{\sum_{r=1}^{K}{t_r}^2 V_{AS}[I(r)]}+\sum_{r\neq K}COV_{AS}[I(r),I(q)]t_rt_q\right]\\&amp;=&amp; K^2\left[\sum_{r=1}^{K}{t_r}^2\frac{1}{K}\left(1-\frac{1}{K}\right)+\sum_{r\neq K}t_rt_q\left(-\frac{1}{K^2}\right)\right]\\&amp;=&amp; K^2\left[\frac{1}{K}\sum_{r=1}^{K}{t_r}^2 - \frac{1}{K^2}\left(\sum_{r=1}^{K}{t_r}^2+\sum_{r\neq K}t_rt_q\right)\right]\\&amp;=&amp;K\left[\sum_{r=1}^{K}{t_r}^2 - \left(\sum_{r=1}^{K}{t_r}\right)^2/K\right]\\&amp;=&amp;K\sum_{r=1}^{K}(t_r-\overline t)^2 (\#eq:eqsis7)
\end{array}
$$

onde: `\(\overline t = \displaystyle \frac 1 K \sum_{r=1}^{K} t_r = \frac Y K\)`

Portanto a vari√¢ncia √© calculada a partir da soma de quadrados dos desvios entre totais das amostras poss√≠veis em relac√£o √† m√©dia destes totais.

Quando `\(N\)` √© conhecido, a vari√¢ncia do estimador da m√©dia populacional √© dada por:

$$
V_{AS}(\overline y_{AS}) = \frac1{N^2} V_{AS}(\widehat Y_{AS})
$$

Um problema que ocorre com a amostragem sistem√°tica simples √© o fato da ordena√ß√£o da popula√ß√£o em rela√ß√£o aos valores da vari√°vel de interesse afetar a vari√¢ncia (precis√£o) dos estimadores. Para demonstrar esse problema, pode-se utilizar a popula√ß√£o apresentada nos exemplos acima, alterando a ordem de suas unidades, para mostrar como isso afeta a composi√ß√£o das poss√≠veis amostras sistem√°ticas.

**(#exm:exmsis9)** Em primeiro lugar, consideramos a popula√ß√£o ordenada tal como foi apresentada na Tabela \@ref(tab:tabsis2) e calculamos a vari√¢ncia do estimador do total considerando as poss√≠veis amostras listadas no Exemplo \@ref(exm:exmsis5). Em seguida, ordenamos a popula√ß√£o em ordem crescente (ou decrescente) dos valores de `\(y\)` e repetimos o c√°lculo da vari√¢ncia. Observa-se que a vari√¢ncia do estimador do total com a popula√ß√£o ordenada diminui consideravelmente em compara√ß√£o com o caso em que n√£o hav√≠amos ordenado a popula√ß√£o. 


```r
# Alterando o separador de decimais para v√≠rgula
options(OutDec=",")

# Comparando a vari√¢ncia do estimador do total na AS
# com a popula√ß√£o em ordem natural e ordenada

# Intervalo de sele√ß√£o e tamanho da popula√ß√£o conhecido
K=4
print(paste("Intervalo de sele√ß√£o K:", K), quote=FALSE)
```

```
## [1] Intervalo de sele√ß√£o K: 4
```

```r
# Popula√ß√£o na ordem natural
# Carregando os valores populacionais da vari√°vel y
pop=matrix(c(99,54,96,54,85,88,55,83,62,85,96,55,91,92,67,68,54,79,76,NA),5,K,byrow=T)
print("Dados populacionais", quote=FALSE)
```

```
## [1] Dados populacionais
```

```r
print(pop)
```

```
##      [,1] [,2] [,3] [,4]
## [1,]   99   54   96   54
## [2,]   85   88   55   83
## [3,]   62   85   96   55
## [4,]   91   92   67   68
## [5,]   54   79   76   NA
```

```r
# Calcula tamanho da popula√ß√£o
N=sum(!is.na(pop))
# Calculando a estimativa do total para cada uma das AS poss√≠veis
tr=NULL
for(i in (1:K)) tr[i] = sum(pop[,i],na.rm=T)
# Calculando a vari√¢ncia do estimador do total
V_YhatAS= K*(var(tr)*(K-1))
# Ordenando a popula√ß√£o em ordem crescente de y
pop_ord = matrix(sort(pop,na.last=T),5,K,byrow=T)
print("Dados populacionais ordenados", quote=FALSE)
```

```
## [1] Dados populacionais ordenados
```

```r
print(pop_ord)
```

```
##      [,1] [,2] [,3] [,4]
## [1,]   54   54   54   55
## [2,]   55   62   67   68
## [3,]   76   79   83   85
## [4,]   85   88   91   92
## [5,]   96   96   99   NA
```

```r
# Calculando a estimativa do total para cada uma das AS poss√≠veis
for(i in (1:K)) tr[i] = sum(pop_ord[,i],na.rm=T)
# Calculando a vari√¢ncia do estimador do total
V_YhatAS_ord=K*(var(tr)*(K-1))
print(paste("Vari√¢ncia do estimador de total - ordem natural:  ", V_YhatAS), quote=FALSE)
```

```
## [1] Vari√¢ncia do estimador de total - ordem natural:   53219
```

```r
print(paste("Vari√¢ncia do estimador de total - ordem crescente:", V_YhatAS_ord), quote=FALSE)
```

```
## [1] Vari√¢ncia do estimador de total - ordem crescente: 20611
```

```r
# Alterando o separador de decimais para ponto
options(OutDec=".")
```
Embora este seja um exemplo extremo, pois na pr√°tica n√£o ter√≠amos como ordenar a popula√ß√£o pelos valores da vari√°vel de interesse, ele mostra bem o efeito que a ordena√ß√£o pode ter na precis√£o dos estimadores baseados em amostras sistem√°ticas simples. Podemos concluir que em popula√ß√µes onde a(s) vari√°vel(eis) de interesse seguem, pelo menos aproximadamente, uma ordena√ß√£o, a AS pode ter um bom desempenho.

Fica como exerc√≠cio para o leitor verificar que o mesmo n√£o ocorre quando se utiliza uma AAS ou AASC, pois nestes casos a ordena√ß√£o dos valores de `\(y\)` na popula√ß√£o n√£o tem influ√™ncia na precis√£o das estimativas.

**Notas:**

1. Como `\(r\)` pode tomar apenas um valor, `\(V_{AS}(\widehat Y_{AS})\)` n√£o pode ser diretamente estimada a partir da amostra.    
2. Em @Cochran1977 √© apresentada uma boa discuss√£o sobre como a ordena√ß√£o dos valores da vari√°vel de pesquisa para unidades populacionais pode afetar a efici√™ncia de amostras sistem√°ticas. Para uma defini√ß√£o de efici√™ncia ver a Express√£o \@ref(eq:eqdom24).   
3. Para popula√ß√µes em 'ordem aleat√≥ria', o desempenho da amostragem sistem√°tica simples √© semelhante ao da amostragem aleat√≥ria simples sem reposi√ß√£o (@Cochran1977, Se√ß√£o 8.5).     
4. Para popula√ß√µes com tend√™ncia linear, amostragem sistem√°tica simples √© melhor que AAS (@Cochran1977, Se√ß√£o 8.6).     
5. Para popula√ß√µes peri√≥dicas, amostragem sistem√°tica simples com intervalo de sele√ß√£o em sincronia com o per√≠odo √© um desastre (@Cochran1977, p√°gina 218).

**Considere o caso especial onde `\(N = nK\)`**

Da Tabela 8.2 do @Cochran1977, p√°gina 207, √© f√°cil ver que `\(\overline y_r = t_r/n_r\)` √© um estimador n√£o viciado para `\(\overline Y\)`. Como

$$
\displaystyle \sum_{r=1}^{K} \sum_{i \in s_r} (y_i - \overline Y)^2 = n \sum_{r=1}^{K} (\overline y_r - \overline Y)^2 + \sum_{r=1}^{K} \sum_{i \in s_r} (y_i - \overline y_r)^2
$$

tem-se que: 
$$
(N-1) S_y^2 = n K V_{AS}(\overline y_{AS}) + K (n-1) S_D^2
$$

onde `\(S_y^2\)` √© a vari√¢ncia populacional total, `\(S_D^2\)` √© a vari√¢ncia *dentro* das amostras sistem√°ticas e `\(V_{AS}(\overline y_{AS})\)` √© a vari√¢ncia de `\(\overline y_{AS}\)` sob amostragem sistem√°tica simples.

Portanto, conforme @Cochran1977, p√°gina 208, o estimador de m√©dia √© mais eficiente sob amostragem sistem√°tica que sob AAS se e somente se `\(S_D^2 &gt; S_y^2\)`.

**Uma express√£o alternativa para `\(V_{AS}(\overline y_{AS})\)` quando `\(N = nK\)`**

De acordo com o Teorema 8.2 de @Cochran1977, p√°gina 209, tem-se:

$$
\begin{array}{ll}
V_{AS}(\overline y_{AS}) &amp; = &amp; \displaystyle\left( \frac {N-1} {N} \right) [1 + (n-1) \rho \,] \frac {S_y^2} {n} 
\\&amp; \doteq  &amp; \displaystyle\left[ 1 + (n-1)\rho \right] \frac {S_y^2} {n} \, \,  (\#eq:eqsis8)
\end{array}
$$ 

onde:

$$
\rho = \frac {1} {(n-1) (N-1) S_y^2} \displaystyle \sum_{r=1}^{K} \sum_{i \neq j \in s_r} (y_i - \overline Y) (y_j - \overline Y) (\#eq:eqsis9)
$$

√© a *correla√ß√£o intraclasse* das amostras sistem√°ticas poss√≠veis.

Este resultado mostra que a correla√ß√£o positiva entre unidades de uma mesma amostra aumenta a vari√¢ncia da m√©dia amostral sob sele√ß√£o sistem√°tica simples quando comparada com a vari√¢ncia da m√©dia amostral sob sele√ß√£o AAS.

Lembrando que sob AAS, `\(V_{AAS}(\overline y_{AAS}) = \displaystyle \left( 1 - \frac {n} {N} \right) \frac {S_y^2} {n}\)`.

Ent√£o, tem-se a rela√ß√£o aproximada:

$$
\frac {V_{AS}(\overline y_{AS})} {V_{AAS}(\overline y_{AAS})} = 1 + (n-1) \rho \, \left\{\begin{array}{lll} &lt; 1, &amp; \textrm{se} \,\,\, \rho&lt;0\, \\ = 1, &amp; \textrm{se} \,\,\,\rho=0 \,\\ &gt; 1, &amp; \textrm{se} \,\,\, \rho&gt;0 \, \end{array} \right. (\#eq:eqsis10)
$$ 

Cabe notar que raz√µes do tipo `\(V_{AS}(\overline y_{AS})/V_{AAS}(\overline y_{AAS})\)` s√£o chamadas de *Efeito do Plano Amostral (EPA)*. Em ingl√™s, usa-se o termo *design effect*, abreviado como *deff*.

## Estima√ß√£o de vari√¢ncias dos estimadores na amostragem sistem√°tica simples

Quando se usa amostragem sistem√°tica simples n√£o h√° um estimador n√£o viciado para a vari√¢ncia dos estimadores do total e da m√©dia. O que se faz √© utilizar estimadores mais adequados de acordo com a ordena√ß√£o da popula√ß√£o.

No caso de se poder supor que n√£o h√° uma ordena√ß√£o ou que a popula√ß√£o esteja espalhada aleatoriamente no cadastro de sele√ß√£o em rela√ß√£o √†(s) vari√°vel(eis) de interesse, de modo que as m√©dias dentro de cada intervalo de sele√ß√£o sejam pelo menos aproximadamente iguais `\((\overline Y_r \doteq constante)\)`, o que se pode fazer √© utilizar um estimador para a vari√¢ncia da m√©dia equivalente ao usado quando se tem uma AAS, dado pela express√£o:

$$
\widehat V_{1AS} (\overline y_{AS}) = \left( \frac {1}{n} - \frac 1 {N} \right) \frac {1}{n-1} \sum_{i \in s_r} (y_i - \overline y_{AS})^2 (\#eq:eqsis11)
$$
Esse estimador serve para o caso de `\(N\)` conhecido e ser√° n√£o viciado caso a suposi√ß√£o de ordena√ß√£o aleat√≥ria das unidades na popula√ß√£o esteja correta. No caso de n√£o se conhecer `\(N\)`, pode-se utilizar as alternativas dadas pelos estimadores de raz√£o.

No caso de `\(N\)` conhecido e n√£o houver ordena√ß√£o das unidades da popula√ß√£o, um estimador para a vari√¢ncia do estimador do total √© dado por:

$$
\widehat V_{1AS} (\widehat Y_{AS}) =  N^2\widehat V_{1AS} (\overline y_{AS})(\#eq:eqsis12)
$$
No caso em que a popula√ß√£o esteja ordenada segundo uma "estratifica√ß√£o" de modo que as m√©dias em cada intervalo de sele√ß√£o variem (p.ex.: a popula√ß√£o √© ordenada segundo os valores de `\(y\)`), @Cochran1977 sugere, para estimar a vari√¢ncia do estimador da m√©dia, a express√£o:

$$
 \widehat V_{2AS}(\overline y_{AS}) = \left( \frac {1}{n} - \frac 1 {N} \right) \frac {1}{2(n-1)} \sum_{i \in s_r} (y_i - y_{i+K})^2 (\#eq:eqsis13)
$$
Neste caso, um estimador para a vari√¢ncia do estimador do total √© dado por:

$$
\widehat V_{2AS} (\widehat Y_{AS}) =  N^2\widehat V_{2AS} (\overline y_{AS})(\#eq:eqsis14)
$$

Alternativamente e independentemente da ordena√ß√£o da popula√ß√£o, pode-se usar um estimador do tipo replica√ß√£o, onde s√£o selecionadas `\(q\)` amostras sistem√°ticas de tamanhos `\(n/q\)` cada uma, tomando a vari√¢ncia das estimativas dadas por cada uma das amostras. Essa t√©cnica, tamb√©m chamada *amostra sistem√°tica repetida*, est√° descrita em @Scheaffer2011.

Quando a sele√ß√£o de uma AS for realizada a partir de um cadastro conhecido, √© sempre poss√≠vel reordenar as unidades aleatoriamente antes proceder a sele√ß√£o. Esse √© um artif√≠cio muito √∫til e que permite que se utilizem os estimadores equivalentes aos da AAS para estimar a vari√¢ncia dos estimadores. Se por um lado essa t√©cnica viabiliza o emprego de estimadores simplificados de vari√¢ncia, por outro se espera que acabe resultando em menor precis√£o para a estima√ß√£o pontual.

Pode-se encontrar boas discuss√µes sobre a estima√ß√£o da vari√¢ncia sob amostragem sistem√°tica simples em @Cochran1977 ou @Thompson2012.

A Tabela \@ref(tab:tabsis3) apresenta os estimadores do total, m√©dia  e respectivas vari√¢ncias sob AS.

&lt;center&gt;
&lt;table&gt;
&lt;caption&gt;(#tab:tabsis3)Estimadores do total, m√©dia e respectivas vari√¢ncias sob AS&lt;/caption&gt;
&lt;/table&gt;
----------
Estimador  
----------------------------------
`\(\widehat{Y}_{AS}=Kt_r=K \displaystyle \sum_{r=1}^{K}I(r)t_r\)`

`\(\displaystyle \overline {y}_{AS}=\frac KNt_r,\,\,\text{ se } N \text{ √© conhecido }\)`

`\(\displaystyle  \overline{y}_{AS}= \frac {t_r}{n_r}=\overline y,\,\,\text{ se }N \text{ √© desconhecido }\)`

`\(\widehat V_{1AS} (\widehat Y_{AS}) = N^2\widehat V_{1AS} (\overline y_{AS}),\,\,\text{se}\, N\text{ √© conhecido}\)`\
                                                                        `\(\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\text{e n√£o houver ordena√ß√£o das unidades na popula√ß√£o}\)`                           `\(\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\)`                                                                                                                                                                          `\(\widehat V_{2AS}(\widehat Y_{AS}) = N^2\widehat V_{2AS}(\overline y_{AS}),\,\,\text{se}\, N\text{ √© conhecido}\)`
                                                                        `\(\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\text{e houver ordena√ß√£o das unidades na popula√ß√£o}\)`                         

`\(\widehat V_{1AS} (\overline y_{AS}) = \displaystyle\left(\frac {1}{n} - \frac 1 {N} \right) \frac {1}{n-1}\displaystyle \sum_{i \in s_r} (y_i - \overline y_{AS})^2,\,\, \text{ se  } N \text{ √© conhecido }\)` 
                                                                        `\(\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\text{e n√£o houver ordena√ß√£o das unidades na popula√ß√£o}\)`\                                                          `\(\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\)`                                                                                                 `\(\widehat V_{2AS}(\overline y_{AS}) = \displaystyle\left( \frac {1}{n} - \frac 1 {N} \right) \frac {1}{2(n-1)} \displaystyle\sum_{i \in s_r} (y_i - y_{i+K})^2,\,\, \text{ se  } N \text{ √© conhecido }\)`
                                                                        `\(\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\text{e houver ordena√ß√£o das unidades na popula√ß√£o}\)`                 
----------
&lt;/center&gt;  
    
## Alternativas para sele√ß√£o com amostragem sistem√°tica simples

Como foi visto, existem dificuldades quando o tamanho da popula√ß√£o, `\(N\)`, n√£o √© um m√∫ltiplo de `\(K\)`, ou seja, quando `\(N \ne n K\)`. Neste caso, o estimador simples da m√©dia tem v√≠cio. @Cochran1977 indica que esse v√≠cio pode ser considerado desprez√≠vel quando se trabalha com tamanhos de amostra razoavelmente grandes, podendo-se considerar como tal amostras com tamanhos iguais ou maiores que `\(n=50\)`.

H√° tamb√©m alternativas que podem ser utilizadas quando a sele√ß√£o da amostra sistem√°tica for feita a partir de um cadastro ou lista das unidades populacionais. @Murthy1967, p√°gina 139, recomenda usar um m√©todo de sele√ß√£o 'circular' proposto por Lahiri em 1952, para obter uma amostra sistem√°tica. Esse m√©todo consiste em:

  1)  Tomar como `\(K\)` o inteiro mais pr√≥ximo de `\(N/n\)`, ou `\(K=round(N/n)\)`.
  2)  Selecionar como partida aleat√≥ria um n√∫mero inteiro `\(r \in[1;\: N]\)`.
  3)  Tomar como primeira unidade da amostra a unidade `\(r\)`.
  4)  Em seguida, selecionar as unidades seguintes sempre somando `\(K\)` ao √≠ndice da √∫ltima unidade selecionada; quando `\(r+jK &gt; N\)`, subtrair `\(N\)` e continuar o processo at√© obter as `\(n\)` unidades amostrais desejadas.
  
**(\#exm:exmsis10)**  Seja uma popula√ß√£o de `\(N=21\)` unidades da qual se deseja selecionar uma amostra sistem√°tica de exatamente `\(n=5\)` unidades. O *script* a seguir seleciona uma amostra sistem√°tica circular com o tamanho desejado. Note que nesse caso `\(K=4\)`.
  

```r
# Alterando o separador de decimais para v√≠rgula
options(OutDec=",")
# Definindo a semente para permitir replica√ß√£o
set.seed(77099)
# Tamanho da popula√ß√£o
N=21
# Tamanho exato da amostra desejada
n=5
# Passo 1: calculando o valor de K
(K=round(N/n))
```

```
## [1] 4
```

```r
# Passo 2: selecionando a partida aleat√≥ria r
r=sample(1:N,1)
# Definindo a primeira unidade amostral
sr=NULL
sr[1]=r
# Definindo as demais unidades amostrais
for(i in (2:n)){
  sr[i]=sr[i-1]+K
  if(sr[i]&gt;N) sr[i]=sr[i]-N
}
# Exibindo a partida
r
```

```
## [1] 18
```

```r
# Exibindo a amostra selecionada
sr
```

```
## [1] 18  1  5  9 13
```

```r
# Alterando o separador de decimais para ponto
options(OutDec=".")
```

Note que com uma *Amostra Sistem√°tica circular - ASc*, o n√∫mero de amostras poss√≠veis √© `\(N\)` e pode-se definir estimadores n√£o viciados para a m√©dia e o total da vari√°vel de interesse `\(y\)`, como:

$$
\overline y_{ASc}=\overline y=\frac 1n \sum_{i=1}^n y_i (\#eq:eqsis15)
$$ 

e

$$
\widehat Y_{ASc}=N\overline y_{ASc} (\#eq:eqsis16)
$$

Neste m√©todo a sele√ß√£o √© feita com equiprobabilidade e sem reposi√ß√£o, como na AS tradicional, por√©m √© necess√°rio que `\(N\)` seja conhecido e a sele√ß√£o √© um pouco mais trabalhosa. A vantagem √© que os estimadores s√£o sempre n√£o viciados.

Fica para o leitor verificar que os estimadores para a m√©dia e total s√£o n√£o viciados.

---

## Para casa üè†

&lt;!-- * Fazer a lista 2 de exerc√≠cios. --&gt;

* Continuar exerc√≠cios.

&lt;!-- Continuar o Exerc√≠cio. --&gt;

&lt;!-- * Mostrar tamanho de amostra `\(n\)` para AASc dentro dos estratos. --&gt;

&lt;!-- * Continuar exerc√≠cios do livro 'Amostragem: Teoria e Pr√°tica Usando R'    https://amostragemcomr.github.io/livro/estrat.html#exerc11 --&gt;

* Ler o cap√≠tulo 3 da apostila da Profa. Vanessa.

* Ler o cap√≠tulo 8 do livro 'Amostragem: Teoria e Pr√°tica Usando R'.

* Rever os slides.

&lt;!-- * Ler BOlfarine e Bussab...da se√ß√£o 11.3 do livro 'Amostragem: Teoria e Pr√°tica Usando R'. --&gt;

* Prepara√ß√£o para avalia√ß√£o parcial 2

## Pr√≥xima aula üìä

* Acompanhar o material no moodle.

Amostragem Sistem√°tica

  + Estima√ß√£o.

  &lt;!-- + Laborat√≥rio de &lt;i class="fa-duotone fa-people-group"&gt;&lt;/i&gt;<svg aria-hidden="true" role="img" viewBox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:steelblue;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> --&gt;

---

## Muito obrigado!

&lt;img src="img/image_basu_elephant.jpg" width="20%" height="20%" style="display: block; margin: auto;" /&gt;
.center[
#### Fonte: imagem do livro *Combined Survey Sampling Inference: Weighing of Basu's Elephants*.
]


---

## Refer√™ncias

&lt;!-- Slides baseados no Cap√≠tulo 11 do livro --&gt;

* [Amostragem: Teoria e Pr√°tica Usando o R](https://amostragemcomr.github.io/livro/index.html)

* **Elementos de Amostragem**, Bolfarine e Bussab.

&lt;!-- Cita√ß√µes do Cap√≠tulo --&gt;

&lt;!-- * Neyman(1934) --&gt;

* Cochran(1977)


&lt;!-- * refazer calculos para amostagem aleatoria simples com reposicao --&gt;
&lt;!-- * alocacao... ou lab R comparando aloca√ß√£o proporcional e igual tamanho --&gt;

&lt;!-- listas de exercicios... --&gt;
&lt;!-- dois aspectos da disciplina... ter flexibilidade com teoria... exercitar os conceitos com exercicios teoricos e praticos --&gt;

&lt;!-- falar dos pesos na AES --&gt;

&lt;!-- valor z_alpha/2 significa z ou t --&gt;

&lt;!-- quem tiver interesse em conferir as f√≥rmulas... mostra as conttas, gosta dessa pparte...posso contabilizar ponto extra... tem q ser o primeira... --&gt;
&lt;!-- o mesmo pode valer para os c√≥digos e texto... --&gt;
&lt;!-- fazer o formul√°rio --&gt;
&lt;!-- resumo de formulas --&gt;

---

## Resumo da nota√ß√£o

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
